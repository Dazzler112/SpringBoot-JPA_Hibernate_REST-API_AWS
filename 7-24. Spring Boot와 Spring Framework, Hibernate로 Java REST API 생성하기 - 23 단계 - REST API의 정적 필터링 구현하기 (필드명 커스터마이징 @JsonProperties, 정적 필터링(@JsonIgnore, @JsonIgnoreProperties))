

Custommizing REST API Responses - Filtering and more..

â— Serialization: Convert object to stream (example: JSON)                                     _____________________________________
  â–  Most popular JSON Serialization in Java: Jackson                                            localhost:8080/filtering-list
â— How about customizing the REST API response returned by Jackson framework?                  â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾
â— 1: Customize filed names in response                                                        [
  â–  @JSONProperty                                                                               {
                                                                                                  "field2": "value2",
                                                                                                  "field3": "value3"
                                                                                                },
                                                                                                {
                                                                                                  "field2": "value22",
                                                                                                  "field3": "value32"
                                                                                                }
                                                                                              ]
                                                                                              _____________________________________
                                                                                                localhost:8080/filtering
                                                                                              â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾
                                                                                                {
                                                                                                  "field1": "value1",
                                                                                                  "field2": "value2",
                                                                                                  "field3": "value3"
                                                                                                }



ì´ë²ˆ ì‹œê°„ì—ëŠ” REST API ì‘ë‹µ ì»¤ìŠ¤í„°ë§ˆì´ì§•ì— ëŒ€í•´ ì‚´í´ë³´ê² ë‹¤
â— Serialization: Convert object to stream (example: JSON) 
ì§ë ¬í™”ë€ ë¬´ì—‡ì¼ê¹Œ? 
ì§ë ¬í™”ëŠ” ê°ì²´ë¥¼ ìŠ¤íŠ¸ë¦¼ìœ¼ë¡œ ì „í™˜í•˜ëŠ” í”„ë¡œì„¸ìŠ¤ì´ë‹¤

ê°€ë ¹, 
-------------------------------------------

	@GetMapping("/users")
	public List<User> retrieveAllUsers() {
		return service.findAll();
	}

  @GetMapping("/users/{id}")
	public EntityModel<User> retrieveUser(@PathVariable int id) {
		User user = service.findOne(id);
		
		if(user == null)
			throw new UserNotFoundException("id:"+id);
		
		EntityModel<User> entityModel = EntityModel.of(user);
		
		WebMvcLinkBuilder link = linkTo(methodOn(this.getClass()).retrieveAllUsers());
		entityModel.add(link.withRel("all-users"));
		
		return entityModel;

	}
-------------------------------------------
EntityModelì„ ë°˜í™˜í•˜ê±°ë‚˜ List<User>ë¥¼ ë°˜í™˜í•œë‹¤ê³  ê°€ì •í•´ë³´ì
ì´ê²ƒì„ JSONì´ë‚˜ XMLë¡œ ì „í™˜í•˜ëŠ” ì‘ì—…ì„ ë°”ë¡œ ì§ë ¬í™”ë¼ê³  í•˜ëŠ”ë° 
  â–  Most popular JSON Serialization in Java: Jackson   
ê°€ì¥ ì¸ê¸°ê°€ ë§ì€ ìë°”ì˜ JSON ì§ë ¬í™” í”„ë ˆì„ì›Œí¬ëŠ” Jacksonì´ë‹¤ 

ì§€ê¸ˆê¹Œì§€ ì´ Userì˜ êµ¬ì¡°ê°€ ë¬´ì—‡ì´ë“  ì •í™•íˆ ì‘ë‹µì— ìˆë‹¤ëŠ” ê²ƒì„ í™•ì¸í–ˆì—ˆì§€
-------------------------------------------
package com.in28minutes.rest.webservices.restfulwebservices.user;

import java.time.*;

import jakarta.validation.constraints.*;

public class User {

	private Integer id;
	
	@Size(min=2, message = "Name should have atleast 2 characters")
	private String name;
	
	@Past(message = "Birth Date should be in the past")
	private LocalDate birthDate;
.....
-------------------------------------------
ë”°ë¼ì„œ JSON ì‘ë‹µì€ ì´ User ë¹ˆì˜ êµ¬ì¡°ì™€ ì •í™•íˆ ì¼ì¹˜í•œë‹¤
-----------------------------------------------------

localhost:8080/users ì‚¬ì´íŠ¸ í™”ë©´ ==>

[
  {
    "id": 1,
    "name": "Adam",
    "birthDate": "1994-06-02"
  },
  {
    "id": 2,
    "name": "Eve",
    "birthDate": "1999-06-02"
  },
  {
    "id": 3,
    "name": "Jim",
    "birthDate": "2004-06-02"
  }
]

-----------------------------------------------------
id, name, birthDateë¥¼ ê°€ì§€ê³  ìˆëŠ”ë°, ì´ëŠ” ì •í™•íˆ ì‘ë‹µì´ êµ¬ì¡°ì— í•´ë‹¹í•œë‹¤ 
ì—¬ê¸°ì„œë„ id, name, birthDateë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤

â— How about customizing the REST API response returned by Jackson framework? 
íŠ¹ì • ìƒí™©ì—ì„œëŠ” ì´ì™€ ê°™ì´ ì •í™•í•œ êµ¬ì¡°ë¥¼ ë°˜í™˜í•˜ê³  ì‹¶ì§€ ì•Šì„ ë•Œë„ ìˆëŠ”ë° 
Jackson í”„ë ˆì„ì›Œí¬ê°€ ë°˜í™˜í•˜ëŠ” REST APIì‘ë‹µì„ ì»¤ìŠ¤í„°ë§ˆì´ì§•í•´ì•¼ í•˜ê¸°ë„ í•œë‹¤

ì´ë²ˆ ê°•ì˜ì™€ ë‹¤ìŒ ê°•ì˜ë¥¼ í†µí•´ ì»¤ìŠ¤í„°ë§ˆì´ì§•ì„ í•  ìˆ˜ ìˆëŠ” ëª‡ ê°€ì§€ ì˜µì…˜ì— ëŒ€í•´ ì•Œì•„ë³´ë„ë¡ í•˜ê² ë‹¤

ğŸ”µ ì‘ë‹µ í•„ë“œëª… ì»¤ìŠ¤í„°ë§ˆì´ì§•

â— 1: Customize filed names in response     
ë¨¼ì € ì‘ë‹µì˜ í•„ë“œ ì´ë¦„ì„ ì»¤ìŠ¤í„°ë§ˆì´ì§•í•˜ëŠ” ë°©ë²•ì„ ì•Œì•„ë³¼ê¹Œ?
  â–  @JSONProperty    
ì‘ë‹µì˜ í•„ë“œ ì´ë¦„ì„ ì»¤ìŠ¤í„°ë§ˆì´ì§•í•˜ëŠ” ë°©ë²•ì€ ë¬´ì—‡ì¼ê¹Œ?
@JSONProperty ì–´ë…¸í…Œì´ì…˜ì„ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤

ë°”ë¡œ ì‹¤í–‰í•˜ì—¬ í™•ì¸í•´ë³¼ê¹Œ?
(User í´ë˜ìŠ¤íŒŒì¼..) nameì„ ì»¤ìŠ¤í„°ë§ˆì´ì§• í•˜ëŠ” ê²½ìš°, name ëŒ€ì‹ ì— ë‹¤ë¥¸ ê²ƒì„ ë°˜í™˜í•œë‹¤ê³  ê°€ì •í•´ë³´ì
----------------------------------------------------------------------------------------------------------


âº User í´ë˜ìŠ¤íŒŒì¼



package com.in28minutes.rest.webservices.restfulwebservices.user;

import java.time.*;

import com.fasterxml.jackson.annotation.*;

import jakarta.validation.constraints.*;

public class User {

	private Integer id;
	
	@Size(min=2, message = "Name should have atleast 2 characters")
  //1: @JASONPropertyë¥¼ ì¶”ê°€í•˜ê³ , com.fasterxml.jackson.annotationì„ ì„í¬íŠ¸ í•œë‹¤ 
  //Marker annotation that can be used to define a non-staticmethod as a "setter" or "getter" for a logical propertyaccessor (depending on its signature),or a non-static Object field to be used (serialized, deserialized)as a logical property (to assign value or get value from) => ë¹„ì–´ ìˆëŠ” ê¸°ë³¸ê°’ì€ í•„ë“œ ì´ë¦„ì´ ìˆ˜ì • ì—†ì´ í”„ë¡œí¼í‹° ì´ë¦„ìœ¼ë¡œ ì‚¬ìš©ëœë‹¤ëŠ” ê²ƒì„ ê°€ë¦¬í‚¤ì§€ë§Œ ë‹¤ë¥¸ ì´ë¦„ì„ ì§€ì •í•˜ê¸° ìœ„í•´ ë¹„ì–´ ìˆì§€ ì•Šì€ ê°’ìœ¼ë¡œ ì§€ì •í•  ìˆ˜ ìˆë‹¤ê³  ë¼ìˆë‹¤
	//ë°”ë¡œ ì´ê²ƒì„ ë‹¤ì›Œë³´ë„ë¡ í•˜ì, @JASONProperty("user_name")ìœ¼ë¡œ ì‘ì„±í•  ìˆ˜ ìˆëŠ”ë°, ì„í¬íŠ¸ë¥¼ ì •ë¦¬í•˜ê³  ì €ì¥í•´ë³¼ê¹Œ
  private String name;
	
	@Past(message = "Birth Date should be in the past")
	private LocalDate birthDate;
	
	public User(Integer id, String name, LocalDate birthDate) {
		super();
		this.id = id;
		this.name = name;
		this.birthDate = birthDate;
	}

	public Integer getId() {
		return id;
	}

	public void setId(Integer id) {
		this.id = id;
	}

	public String getName() {
		return name;
	}

	public void setName(String name) {
		this.name = name;
	}

	public LocalDate getBirthDate() {
		return birthDate;
	}

	public void setBirthDate(LocalDate birthDate) {
		this.birthDate = birthDate;
	}

	@Override
	public String toString() {
		return "User [id=" + id + ", name=" + name + ", birthDate=" + birthDate + "]";
	}
	
}
----------------------------------------------------------------------------------------------------------
ì´ì œ user APIë¡œ ì´ë™í•´ì„œ ìƒˆë¡œê³ ì¹¨ì„ í•˜ë©´ user_nameì´ í‘œì‹œëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆëŠ”ë°           |   
                                                                                       V
----------------------------------------------------------------------------------------------------------

ğŸŒ http://localhost:8080/users ì‚¬ì´íŠ¸í™”ë©´ ==>


[
  {
    "id": 1,
    "birthDate": "1994-06-02",
    "user_name": "Adam"
  },
  {
    "id": 2,
    "birthDate": "1999-06-02",
    "user_name": "Eve"
  },
  {
    "id": 3,
    "birthDate": "2004-06-02",
    "user_name": "Jim"
  }
]

----------------------------------------------------------------------------------------------------------

ê°™ì€ ë°©ì‹ìœ¼ë¡œ birthDateë¥¼ ì»¤ìŠ¤í„°ë§ˆì´ì§• í•œë‹¤ê³  ê°€ì •í•´ë³´ì, ì´ë²ˆì—ë„ ë§ˆì°¬ê°€ì§€ë¡œ

----------------------------------------------------------------------------------------------------------


âº User í´ë˜ìŠ¤íŒŒì¼



package com.in28minutes.rest.webservices.restfulwebservices.user;

import java.time.*;

import com.fasterxml.jackson.annotation.*;

import jakarta.validation.constraints.*;

public class User {

	private Integer id;
	
	@Size(min=2, message = "Name should have atleast 2 characters")
	@JsonProperty("user_name")
	private String name;
	
	@Past(message = "Birth Date should be in the past")
//2: birthDate ëŒ€ì‹ ì— birth_dateë¥¼ ì…ë ¥í•˜ê² ë‹¤ ì €ì¥í•˜ê³  ìƒˆë¡œê³ ì¹¨ì„ í•˜ë©´..
	@JsonProperty("birth_date")
	private LocalDate birthDate;
	
	public User(Integer id, String name, LocalDate birthDate) {
		super();
		this.id = id;
		this.name = name;
		this.birthDate = birthDate;
	}

	public Integer getId() {
		return id;
	}

	public void setId(Integer id) {
		this.id = id;
	}

	public String getName() {
		return name;
	}

	public void setName(String name) {
		this.name = name;
	}

	public LocalDate getBirthDate() {
		return birthDate;
	}

	public void setBirthDate(LocalDate birthDate) {
		this.birthDate = birthDate;
	}

	@Override
	public String toString() {
		return "User [id=" + id + ", name=" + name + ", birthDate=" + birthDate + "]";
	}
	
}

----------------------------------------------------------------------------------------------------------
                                                                                        |
                                                                                        V
----------------------------------------------------------------------------------------------------------

ğŸŒ http://localhost:8080/users ì‚¬ì´íŠ¸í™”ë©´ ==>


[
  {
    "id": 1,
    "user_name": "Adam",
    "birth_date": "1994-06-02"
  },
  {
    "id": 2,
    "user_name": "Eve",
    "birth_date": "1999-06-02"
  },
  {
    "id": 3,
    "user_name": "Jim",
    "birth_date": "2004-06-02"
  }
]

----------------------------------------------------------------------------------------------------------
birth_dateë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤

JSONPropertyëŠ” ì‘ë‹µì˜ ì†ì„±ê³¼ ìš”ì†Œ ì´ë¦„ì„ ì»¤ìŠ¤í„°ë§ˆì´ì§•í•˜ëŠ” ë° ë¬´ì²™ ìœ ìš©í•˜ë‹¤




Custommizing REST API Responses - Filtering and more..

â— Serialization: Convert object to stream (example: JSON)                                     _____________________________________
  â–  Most popular JSON Serialization in Java: Jackson                                            localhost:8080/filtering-list
â— How about customizing the REST API response returned by Jackson framework?                  â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾
â— 1: Customize filed names in response                                                        [
  â–  @JSONProperty                                                                               {
â— 2: Return only selected fields                                                                  "field2": "value2",
  â–  Filtering                                                                                     "field3": "value3"
  â–  Example: Filter out Password                                                                },
  â–  Two types:                                                                                  {
    â—‹ Static Filtering: Same filtering for a bean across differnt REST API                        "field2": "value22",
      â—¦ @JsonIgnoreProperties, @JsonIgnore                                                        "field3": "value32"
    â—‹ Dynamic Filtering: Customize filtering for a bean for specific REST API                    }
      â—¦ @JsonFilter with FilterProvider                                                        ]
                                                                                              _____________________________________
                                                                                                localhost:8080/filtering
                                                                                              â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾
                                                                                                {
                                                                                                  "field1": "value1",
                                                                                                  "field2": "value2",
                                                                                                  "field3": "value3"
                                                                                                }


â— 2: Return only selected fields   
ì‘ë‹µì—ì„œ í•  ìˆ˜ ìˆëŠ” ë˜ ë‹¤ë¥¸ ì‘ì—…ì€ ì„ íƒëœ í•„ë“œë§Œ ë°˜í™˜í•˜ê¸°ì´ë‹¤
  â–  Filtering  
ì´ê²ƒì€ í•„í„°ë§ì´ë¼ê³  í•˜ëŠ”ë° 
  â–  Example: Filter out Password 
ì˜ˆë¥¼ ë“¤ì–´, ë¹ˆì— ì •ì˜ëœ ë¹„ë°€ë²ˆí˜¸ê°€ ìˆëŠ”ë°, ì‘ë‹µì—ëŠ” ë¹„ë°€ë²ˆí˜¸ë¥¼ ì „ì†¡í•˜ê³  ì‹¶ì§€ ì•Šë‹¤ë©´ ì–´ë–»ê²Œ í•´ì•¼ í• ê¹Œ?
  â–  Two types: 
   â—‹ Static Filtering: Same filtering for a bean across differnt REST API
      â—¦ @JsonIgnoreProperties, @JsonIgnore  
   â—‹ Dynamic Filtering: Customize filtering for a bean for specific REST API  
      â—¦ @JsonFilter with FilterProvider    
í•„í„°ë§ì—ëŠ” ë°”ë¡œ ì •ì  í•„í„°ë§ê³¼ ë™ì  í•„í„°ë§ì˜ ë‘ ê°€ì§€ ìœ í˜•ì´ ìˆë‹¤

ì˜ˆì‹œë¥¼ í†µí•´ ì•Œì•„ë³´ê² ë‹¤ 
3ê°œì˜ í•„ë“œê°€ ìˆëŠ” ë¹ˆì´ ìˆëŠ”ë° 
{
  "field1": "value1",
  "field2": "value2",
  "field3": "value3"
}
field1, field2, field3ê°€ ìˆë‹¤ 
í•­ìƒ field2ë¥¼ í•„í„°ë§í•œë‹¤ê³  ê°€ì •í•´ë³´ì,
field2ëŠ” ë¹„ë°€ë²ˆí˜¸ í•„ë“œì¸ë°, REST API ì‘ë‹µìœ¼ë¡œ ì´ê²ƒì„ ì „ì†¡í•˜ê³  ì‹¶ì§€ ì•Šì€ ìƒí™©ì´ë‹¤
REST APIì™€ ê´€ê³„ì—†ì´ í•­ìƒ field2ë¥¼ ì°¨ë‹¨í•˜ê±°ë‚˜ í•„í„°ë§í•´ì•¼ í•˜ëŠ”ë° ì´ê²ƒì„ ë°”ë¡œ ì •ì  í•„í„°ë§ì´ë¼ í•˜ì§€
   â—‹ Static Filtering: Same filtering for a bean across differnt REST API
      â—¦ @JsonIgnoreProperties, @JsonIgnore  
ì—¬ëŸ¬ REST APIì—ì„œ ë¹ˆì— ì ìš©ëœ ë™ì¼í•œ í•„í„°ë§ì´ë‹¤

ì´ì— ëŒ€í•œ ëŒ€ì•ˆìœ¼ë¡œ ë™ì  í•„í„°ë§ì´ ìˆëŠ”ë°
   â—‹ Dynamic Filtering: Customize filtering for a bean for specific REST API  
      â—¦ @JsonFilter with FilterProvider    
ì˜ˆì‹œë¥¼ ì‚´í´ë³´ëŠ” ê²ƒì´ ì¢‹ê² ë‹¤
íŠ¹ì • REST APIì˜ ì¼ë¶€ë¡œ field1ì„ ì „ì†¡í•˜ê³ ì í•œë‹¤ 
í•˜ì§€ë§Œ ë‹¤ë¥¸ REST APIì˜ ê²½ìš°, ì´ê²ƒì„ ì „ì†¡í•˜ê³  ì‹¶ì§€ ì•Šì€ë° 
ë”°ë¼ì„œ ì‘ë‹µì˜ ì¼ë¶€ë¡œ í•„ë“œë¥¼ ì „ì†¡í• ì§€ ë™ì ìœ¼ë¡œ ê²°ì •í•´ì•¼ í•œë‹¤
ì´ê²ƒì„ ë°”ë¡œ ë™ì  í•„í„°ë§ì´ë¼ê³  í•œë‹¤ 

ê·¸ëŸ¼ ì •ì  í•„í„°ë§ê³¼ ë™ì  í•„í„°ë§ì˜ ëª‡ ê°€ì§€ ì˜ˆì‹œë¥¼ ê°„ë‹¨íˆ ì§šì–´ë³¼ê¹Œ?

ê·¸ëŸ¼ ìƒˆ ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ë§Œë“¤ì–´ ë³´ì íŒ¨í‚¤ì§€ ì´ë¦„ì€ .filteringìœ¼ë¡œ ë§ˆë¬´ë¦¬í•˜ê³  í´ë˜ìŠ¤ëª…ì€ FilteringController ë¡œ í•˜ê³  Finishë¥¼ í´ë¦­


