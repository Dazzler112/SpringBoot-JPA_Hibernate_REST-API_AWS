

지난 몇 섹션에서 우리는 REST API를 많이 만들었다
특정한 Todo 세부정보를 받거나 특정한 사용자와 관련된 모든 Todo의 세부정보를 받을 수 있다
Todo를 업데이트 하거나 삭제하는 등 아주 많은 REST API가 있지 
이 REST API들은 너가 액세스하는 데 인증이나 승인이 필요하지 않다

이번 섹션에선 REST API에 인증을 적용할 것이고 먼저 기본적인 인증을 사용해보고 
이어서 JOT 또는 JWT를 사용해서 REST API를 인증하고 승인해볼 것이다

우리가 사용할 Spring Security라는 프레임워크만을 집중적으로 다루는 별도의 섹션이 있다는 점을 꼭 기억하기 바란다
그럼 먼저 REST API에 빠르게 인증과 승인을 활성화하고 우리의 프론트엔드를 보안 REST API에 연결해보자
그럼 시작할까?

pom.xml로 갈 거고 pom.xml을 열어보자
보안을 추가하기 위해 너가 추가해야 할 내용은 간단하다
바로 Spring Boot Starter다

------------------------------------------------------------------------------------------------------------------


⏺ pom.xml



...
	<dependencies>

		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-web</artifactId>
		</dependency>

    //1: 너는 spring-boot-starter-web을 복사했고, 
		<dependency>
			<groupId>org.springframework.boot</groupId>
        //1-1: 뒤에 security를 붙여주면 될 것이다, 이걸 저장하고
			<artifactId>spring-boot-starter-security</artifactId>
		</dependency>

		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-validation</artifactId>
		</dependency>

		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-devtools</artifactId>
			<scope>runtime</scope>
			<optional>true</optional>
		</dependency>

		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-test</artifactId>
			<scope>test</scope>
		</dependency>

	</dependencies>

	...
------------------------------------------------------------------------------------------------------------------

그리고 애플리케이션을 중지하고 다시 시작해보자

eclipse 콘솔창에
-------------------------------------------
.s.s.UserDetailsServiceAutoConfiguration : 

Using generated security password: 83338c0f-b0b0-4e07-b053-88dfb6de9410

This generated password is for development use only. Your security configuration must be updated before running your application in production.
-------------------------------------------
여기 새로운 보안 패스워드가 프린트된 게 보이지?

그리고 Chrome으로 가서 이 API중 하나를 실행해보자

여기에 GET 요청을 전송해보자
--------------------------------------------------------------------------------------------------------------------------------

🖇 Talend API Tester 화면 ==>    (더 자세한건 크롬 확장프로그램 Talend API Tester 실행해서 확인..)

  METHOD                SCHEME :// HOST [ ":" PORT ] [ PATH [ "?" QUERY ]]
  ______________      ____________________________________________________________    ___________________
 | GET     | ▼  |    |    http://localhost:8080/users/in28minutes/todos/1         |  |  ✈ Send       | ▽ |
  ‾‾‾‾‾‾‾‾‾‾‾‾‾‾      ‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾    ‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾
                        ▶ QUERY PARAMETERS
  HEADERS   ⬇                   | Form ▼ |   ◀ | ▶  BODY                                   | Text ▼ |
‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾     |   ‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾
   _______________     __________________      |    
☑ | Accept        | : |application/json  | x   |    XHR does not allow payload for GET request.                           
   ‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾     ‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾      |                                   
  ______________                               |                                
 ( + Add header )  🗝 Add authorization     🗑  |                                    
  ‾‾‾‾‾‾‾‾‾‾‾‾‾‾                               |                                                                       
                                               |    ‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾
                                                   Text JSON XML HTML | Format Body |
                                                    ☑ Enable body evaluation

                                   

--------------------------------------------------------------------------------------------------------------------------------
                                          |
                                          V
--------------------------------------------------------------------------------------------------------------------------------

🖇 Talend API Tester 화면 ==>    (더 자세한건 크롬 확장프로그램 Talend API Tester 실행해서 확인..)


  Response
‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾
  401                (빨간 바탕)
___________________________________________________________________________________________________

  HEADERS                     | pretty ▼ |      ◀ | ▶  BODY                                 | pretty ▼ |
‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾         |   ‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾
                                                  |
WWW-Authenticate:	Basic realm="Realm"             |  
X-Content-Type-Options:	nosniff                   |
X-XSS-Protection:	1; mode=block                   |
Cache-Control:no-cache, no-store,                 |
              max-age=0, must-revalidate          |
Pragma:	no-cache                                  |                      No Content
Expires:	0                                       |
X-Frame-Options:	DENY                            |
WWW-Authenticate:	Basic realm="Realm"             |
Content-Length:	0 byte                            |
Date:	Wed, 07 Aug 2024 06:32:26 GMT               |
Keep-Alive:	timeout=60                            |
Connection:	keep-alive                            |                                       
                                                  |                                                                                                                                                 
                                                  |                  
▶ COMPLETE REQUEST HEADERS                        |                                              
                                                  |
                                                   
--------------------------------------------------------------------------------------------------------------------------------

401을 받는 게 보인다
인증되지 않은 것이지
이제 가서 인증을 추가해보자

--------------------------------------------------------------------------------------------------------------------------------

🖇 Talend API Tester 화면 ==>    (더 자세한건 크롬 확장프로그램 Talend API Tester 실행해서 확인..)

  METHOD                SCHEME :// HOST [ ":" PORT ] [ PATH [ "?" QUERY ]]
  ______________      ____________________________________________________________    ___________________
 | GET     | ▼  |    |    http://localhost:8080/users/in28minutes/todos/1         |  |  ✈ Send       | ▽ |
  ‾‾‾‾‾‾‾‾‾‾‾‾‾‾      ‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾    ‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾
                        ▶ QUERY PARAMETERS
  HEADERS   ⬇                   | Form ▼ |   ◀ | ▶  BODY                                   | Text ▼ |
‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾     |   ‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾
   _______________     __________________      |    
☑ | Accept        | : |application/json  | x   |    XHR does not allow payload for GET request.                           
   ‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾     ‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾      |                                   
  ______________                               |                                
 ( + Add header )  🗝 Add authorization     🗑  |                                    
  ‾‾‾‾‾‾‾‾‾‾‾‾‾‾                               |                                                                       
                                               |    ‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾
                                                   Text JSON XML HTML | Format Body |
                                                    ☑ Enable body evaluation

                                   

--------------------------------------------------------------------------------------------------------------------------------
( 여기서  🗝 Add authorization 이부분을 클릭하면)
너는 가서 사용자 이름과 패스워드를 설정할 수 있고 기본 사용자 이름은 user이고, 기본 패스워드는 로그에 프린트된 패스워드이다
그럼 콘솔창에 나온걸 복사해서 붙여넣는다, 기본값으로서 사용자 ID와 패스워드가 설정되고 너는 
                                        |
                                        V
 ________________________________________________________________
|  Authorization                                              x  |
| ‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾|
|                    _______________                             |
|              Type | Authorization |                            |
|                    ‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾                             |
|                    ______________________                      |
|          Username |user                  |                     |
|                    ‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾                      |
|                    ______________________                      |
|          Password |●●●●●●●●●●●●●●●●●●●●●●|                     |
|                    ‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾                      |
|                    ▢ show password                             |
|                                                                |
|‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾|
|                                        __________    _______   |
|                                       | x Cancel |  | ✔ Set |  |
|                                        ‾‾‾‾‾‾‾‾‾‾    ‾‾‾‾‾‾‾   |
 ‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾
여기서 Set을 클릭할 수 있지
                            |
                            V
--------------------------------------------------------------------------------------------------------------------------------

🖇 Talend API Tester 화면 ==>    (더 자세한건 크롬 확장프로그램 Talend API Tester 실행해서 확인..)

  METHOD                SCHEME :// HOST [ ":" PORT ] [ PATH [ "?" QUERY ]]
  ______________      ____________________________________________________________    ___________________
 | GET     | ▼  |    |    http://localhost:8080/users/in28minutes/todos/1         |  |  ✈ Send       | ▽ |
  ‾‾‾‾‾‾‾‾‾‾‾‾‾‾      ‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾    ‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾
                        ▶ QUERY PARAMETERS
  HEADERS   ⬇                   | Form ▼ |   ◀ | ▶  BODY                                   | Text ▼ |
‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾     |   ‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾
   _______________     __________________      |    
☑ | Accept        | : |application/json  | x   |    XHR does not allow payload for GET request.                           
   ‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾     ‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾      |  
   _______________     __________________      |    
☑ | Authorization | : |Basic dXNlcjo4MzMz| x 🗝|                            
   ‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾     ‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾      |
  ______________                               |                                
 ( + Add header )  🗝 Add authorization     🗑  |                                    
  ‾‾‾‾‾‾‾‾‾‾‾‾‾‾                               |                                                                       
                                                    ‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾
                                                   Text JSON XML HTML | Format Body |
                                                    ☑ Enable body evaluation

                                   

--------------------------------------------------------------------------------------------------------------------------------

   _______________     __________________          
☑ | Authorization | : |Basic dXNlcjo4MzMz| x 🗝                            
   ‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾     ‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾      
Authorization <= 이게 인증 헤더이고 기본 인증 헤더이다, 그리고 너는 Send를 클릭할 수 있지
                                          |
                                          V
--------------------------------------------------------------------------------------------------------------------------------

🖇 Talend API Tester 화면 ==>    (더 자세한건 크롬 확장프로그램 Talend API Tester 실행해서 확인..)


  Response
‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾
  200                (초록 바탕)
___________________________________________________________________________________________________

  HEADERS                     | pretty ▼ |      ◀ | ▶  BODY                                 | pretty ▼ |
‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾         |   ‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾‾
Vary:	Origin                                      |
Vary:	Access-Control-Request-Method               |        {
Vary:	Access-Control-Request-Headers              |          id: 1,
X-Content-Type-Options:	nosniff                   |          username: "in28minutes",
X-XSS-Protection:	1; mode=block                   |          description: "Get AWS Certified",
Cache-Control: no-cache, no-store,                |          targetDate: "2034-08-07",
               max-age=0, must-revalidate         |          done: false
Pragma:	no-cache                                  |         }
Expires:	0                                       |
X-Frame-Options:	DENY                            |
Content-Type:	application/json                    |
Transfer-Encoding: chunked                        |
Date:	Wed, 07 Aug 2024 07:07:28 GMT               |
Keep-Alive:	timeout=60                            |
Connection:	keep-alive                            |
Set-Cookie: JSESSIONID=33 B, session, HttpOnly/   |
                                                  |
▶ COMPLETE REQUEST HEADERS                        |                                              
                                                  |
                                                    lines nums  📄 copy              length: 106 bytes 
--------------------------------------------------------------------------------------------------------------------------------

그럼 이제 너는 API에 액세스할 수 있다 

지금 우리는 우리의 모든 컨트롤러와 모든 리소스가 이제 보호되고 있는 걸 알 수 있다 
너가 Spring Security를 클래스 경로에 추가하자마자 Spring Boot는 REST API에 있는 모든 리소스를 보호하기 위해
자동으로 필터를 설정할 것이다 
다음 단계에서는 그걸 맞춤화하는 작업을 할 것이고 
기본값으로서 Spring Security는 모든 REST API에 보안을 추가할 것이다
그리고 기본 패스워드는 
-------------------------------------------
.s.s.UserDetailsServiceAutoConfiguration : 

Using generated security password: 83338c0f-b0b0-4e07-b053-88dfb6de9410

This generated password is for development use only. Your security configuration must be updated before running your application in production.
-------------------------------------------
여기 프린트되지

하지만 이런 건 별로 좋지 않다 
우린 보호되어야 할 URL을 선택하려 하고, 사용자 ID와 패스워드 그리고 이런 모든 걸 우리가 지정할 수 있길 원한다

지금 사용자 이름과 패스워드를 어떻게 지정할 수 있는지 지금 바로 알아보자 

