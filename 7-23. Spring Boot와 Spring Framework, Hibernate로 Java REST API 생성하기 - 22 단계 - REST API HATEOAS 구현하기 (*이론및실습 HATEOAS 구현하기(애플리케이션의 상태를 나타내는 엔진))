

HATEOAS

â— Hypermedia as the Engine of Application State (HATEOAS)                                   {
â— Websites allow you to:                                                                      "name": "Adam",
  â–  See Data And Perform Actions (using links)                                                "birthDate": "2024-06-01",
â— How about enhancing your REST API to tell consumers how to perform subsequent actions?         "_links": {
  â–  HATEOAS                                                                                       "all-users": {
â— Implementation Options:                                                                         "href": "http://localhost:8080/users" 
  â–  1: Custom Format and Implementation                                                          }
    â—‹ Difficult to maintain                                                                    }
  â–  2: Use Standard Implementation                                                          }                                
    â—‹ HAL (JSON Hypertext Application Language): Simple format that gives a consistent
    and easy way to hyperlink between resources in your API
    â—‹ Spring HATEOAS: Generate HAL response with hyperlinks to resources                                                                                                                          
                                                                                                                          
                                                                                                                          
                                                                                                                                                                                                                                        
                                                                                                                          
                                                                                                                                                                                                                                                                                                                                                                           
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  
ì´ë²ˆ í•™ìŠµì—ì„  HATEOASë¥¼ ì‚´í´ë³´ê² ë‹¤ 
HATEOAS, ì¦‰ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ìƒíƒœë¥¼ ë‚˜íƒ€ë‚´ëŠ” ì—”ì§„ìœ¼ë¡œ, ì‚¬ìš©í•˜ëŠ” í•˜ì´í¼ë¯¸ë””ì–´ë€ ë¬´ì—‡ì¼ê¹Œ?
ì–´ë–¤ ì‚¬ëŒì´ REST API êµ¬ì¶•ì˜ ì „ë¬¸ê°€ë¼ê³  ìë¶€í•œë‹¤ë©´ ê·¸ ì‚¬ëŒì„ ê´´ë¡­í ìˆ˜ ìˆëŠ” ì¢‹ì€ ë°©ë²•ì€ 
HATEOASê°€ ë¬´ì—‡ì˜ ì•½ìì¸ì§€ ë¬¼ì–´ë³´ëŠ” ê²ƒì´ë‹¤,
â— Hypermedia as the Engine of Application State (HATEOAS)
HATEOASëŠ” Hypermedia as the engine of Application Stateì˜ ì•½ìë¡œ ë³´ëŠ” ê²ƒì²˜ëŸ¼ êµ‰ì¥íˆ ë³µì¡í•œë° ìì„¸íˆ ì‚´í´ë³´ë„ë¡ í•˜ì
â— Websites allow you to:   
  â–  See Data And Perform Actions (using links)
ìš°ë¦¬ëŠ” ì›¹ì‚¬ì´íŠ¸ì— ì ‘ì†í•  ë•Œë§ˆë‹¤ ë°ì´í„°ë¥¼ í™•ì¸í•˜ê³  ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ ìˆë‹¤ (Git Hubì—ì„œ ì•„ë¬´ Repositoryë¥¼ í´ë¦­í•´ ë³´ë©´ ë³¼ ìˆ˜ ìˆìŒ)
GitHub ì €ì¥ì†Œë¥¼ ê°€ë©´ ì´ì™€ ê°™ì´ íŠ¹ì • ì €ì¥ì†Œì— ëŒ€í•œ ë°ì´í„°ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤
ì´ ì›¹ì‚¬ì´íŠ¸ì—ëŠ” ë°ì´í„°ê°€ ë§ë‹¤ ê²Œë‹¤ê°€ ì´ íŠ¹ì • ì €ì¥ì†Œì—ì„œ ì‘ì—…ì„ ìˆ˜í–‰í•  ìˆ˜ë„ ìˆëŠ”ë° 
ë³„ì„ ë‹¤ë£¨ê³  ì‹¶ë‹¤ë©´ ë¡œê·¸ì¸ì„ í•œ ë‹¤ìŒ ì´ íŠ¹ì • ì‚¬í•­ì„ ì²˜ë¦¬í•˜ë©´ ëœë‹¤ 
ì´ ì €ì¥ì†Œë¥¼ Fork í•˜ë ¤ëŠ” ê²½ìš° ë¡œê·¸ì¸ì„ í•œ ë‹¤ìŒ ì €ì¥ì†Œë¥¼ Forkí•˜ë©´ ëœë‹¤
ì›¹ì‚¬ì´íŠ¸ì—ì„  ë°ì´í„°ë¥¼ í‘œì‹œí•  ë¿ë§Œ ì•„ë‹ˆë¼, ì‘ì—…ë„ ìˆ˜í–‰í•  ìˆ˜ ìˆëŠ”ë° 

â— How about enhancing your REST API to tell consumers how to perform subsequent actions?
  â–  HATEOAS
REST APIë¥¼ í–¥ìƒí•˜ì—¬ ì†Œë¹„ìì—ê²Œ í›„ì† ì‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ” ë°©ë²•ì„ ì•Œë ¤ì£¼ë©´ ì–´ë–¨ê¹Œ?
HATEOASê°€ ë˜ì§€ëŠ” ì§ˆë¬¸ì€ 'REST API'ë¥¼ í–¥ìƒí•˜ì—¬ ë°ì´í„°ë¥¼ ë°˜í™˜í•  ë¿ë§Œ ì•„ë‹ˆë¼ ë¦¬ì†ŒìŠ¤ì— ê´€í•œ ì‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ” ë°©ë²•ì˜ ì •ë³´ë¥¼ ì œê³µí•˜ë©´ ì–´ë–¨ê¹Œ? ì´ë‹¤
â— Implementation Options: 
ì—¬ê¸°ì—ì„œëŠ” ì‘ë‹µìœ¼ë¡œ nameê³¼ birthDateë¥¼ í™•ì¸í•  ìˆ˜ ìˆëŠ”ë° ë˜í•œ ì´ ë§í¬ëŠ” í›„ì† ì‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ” ë°©ë²•ì„ ì†Œë¹„ìì—ê²Œ ì•Œë ¤ì¤€ë‹¤
ì‚¬ìš©ìê°€ all-usersë¡œ ë‹¤ì‹œ íƒìƒ‰í•˜ëŠ” ë°©ë²•ì€ ë¬´ì—‡ì¼ê¹Œ?
ëª‡ ê°€ì§€ ì˜µì…˜ì„ í†µí•´ ì´ëŸ¬í•œ ê²ƒì„ êµ¬í˜„í•  ìˆ˜ ìˆëŠ”ë°
  â–  1: Custom Format and Implementation
ì²« ë²ˆì§¸ ì˜µì…˜ì€ ì‚¬ìš©ì ì •ì˜ í˜•ì‹ì„ ì„¤ê³„í•˜ì—¬ ì‚¬ìš©ì ì •ì˜ êµ¬í˜„ì„ ìƒì„±í•˜ëŠ” ê²ƒì´ë‹¤
    â—‹ Difficult to maintain     
ì‚¬ìš©ì ì •ì˜ í˜•ì‹ê³¼ êµ¬í˜„ì„ ì •ì˜í•˜ëŠ” ê²ƒì€ ìœ ì§€ ê´€ë¦¬í•˜ê¸°ì— ê¹Œë‹¤ë¡œìš´ë°
------------------------------------------
package com.in28minutes.rest.webservices.restfulwebservices.user;

import java.time.*;

import jakarta.validation.constraints.*;

public class User {

	private Integer id;
	
	@Size(min=2, message = "Name should have atleast 2 characters")
	private String name;
	
	@Past(message = "Birth Date should be in the past")
	private LocalDate birthDate;
...
------------------------------------------
ì—¬ê¸°ì—ëŠ” id, name, birthDateê°€ ìˆë‹¤
ì´ ë§í¬ë¥¼ ì €ì¥í•˜ë ¤ë©´ ì´ì²˜ëŸ¼ êµ¬ì¡°ë¥¼ ìƒì„±í•´ì•¼ í•œë‹¤
_linksë¼ëŠ” ê²ƒì„ ìƒì„±í•˜ê³  ì•„ë˜ì—ëŠ” ì´ë¦„ì„ ì €ì¥í•˜ë©°, ê·¸ ì•„ë˜ì—ëŠ” ë§í¬ ë˜ëŠ” hrefë¥¼ ì…ë ¥í•œë‹¤ 
ë¹ˆì—ì„œ ì´ ëª¨ë“  êµ¬ì¡°ë¥¼ ìƒì„±í•œ ë‹¤ìŒ, ì‚¬ìš©ì ì •ì˜ êµ¬í˜„ì„ ìƒì„±í•  ìˆ˜ ìˆì§€
  â–  2: Use Standard Implementation     
ë‹¤ë¥¸ ì˜µì…˜ìœ¼ë¡œëŠ” í‘œì¤€ êµ¬í˜„ì´ ìˆëŠ”ë° 
    â—‹ HAL (JSON Hypertext Application Language): Simple format that gives a consistent
    and easy way to hyperlink between resources in your API
ì—¬ê¸°ì„œ ë³´ê³  ê³„ì‹  ê²ƒì€ HAL ì´ ì •ì˜í•œ í‘œì¤€ì´ë‹¤, HALì€ JSON í•˜ì´í¼í…ìŠ¤íŠ¸ ì• í”Œë¦¬ì¼€ì´ì…˜ ì–¸ì–´ë¡œ 
APIì˜ ë¦¬ì†ŒìŠ¤ ê°„ì— í•˜ì´í¼ë§í¬ë¥¼ ìƒì„±í•˜ëŠ” ì¼ê´€ì ì´ê³  ì‰¬ìš´ ë°©ë²•ì„ ì œê³µí•˜ëŠ” ê°„ë‹¨í•œ í˜•ì‹ì´ë‹¤
ë”°ë¼ì„œ ì´ í‘œì¤€ì—ì„  REST APIì˜ ë‹¤ë¥¸ ë¦¬ì†ŒìŠ¤ì— ì—°ê²°í•˜ëŠ” ë°©ë²•ì„ ì •ì˜í•œë‹¤
_linksë¼ëŠ” ìš”ì†Œë¥¼ ìƒì„±í•˜ë©´ ê·¸ ì•ˆì— ì—¬ëŸ¬ ë§í¬ë¥¼ ê°€ì§ˆ ìˆ˜ ìˆë‹¤ 

ì´ê²ƒì´ ë°”ë¡œ HALì´ ì •ì˜í•˜ëŠ” í‘œì¤€ì¸ë° í‘œì¤€ì„ ê°–ê³  ìˆìœ¼ë©´ ì¢‹ì€ ì ì€ ëª¨ë“  ì• í”Œë¦¬ì¼€ì´ì…˜ì´ ì´ í‘œì¤€ì„ ë”°ë¥¸ë‹¤ëŠ” ê²ƒì´ë‹¤
HAL í˜¸í™˜ REST APIì˜ ì‘ë‹µìœ¼ í™•ì¸í•  ë•Œ ë§ˆë‹¤ ì´ì²˜ëŸ¼ ì´ ë§í¬ë¥¼ ë°›ì„ ìˆ˜ ìˆë‹¤
    â—‹ Spring HATEOAS: Generate HAL response with hyperlinks to resources 
ì´ëŸ¬í•œ ì‘ë‹µì„ ìƒì„±í•˜ë ¤ë©´ ë¦¬ì†ŒìŠ¤ì— ëŒ€í•œ í•˜ì´í¼ë§í¬ë¡œ HALì‘ë‹µì„ ìƒì„±í•˜ëŠ” ìŠ¤í”„ë§ HATEOASë¥¼ ì‚¬ìš©í•˜ë©´ ë˜ëŠ”ë°
ê·¸ëŸ¼ ìŠ¤í”„ë§ HATEOASì™€ HALì„ êµ¬ì²´ì ìœ¼ë¡œ ì‚´í´ë³¼ê¹Œ??

ë¨¼ì € ì˜ì¡´ì„±ì„ ì„í¬íŠ¸ í•´ì•¼ í•œë‹¤
ìŠ¤í”„ë§ ë¶€íŠ¸ í”„ë¡œì íŠ¸ì—ì„œ HATEOASì˜ ì‚¬ìš©ì€ ë¬´ì²™ ê°„í¸í•˜ë‹¤
spring-boot-starter-webì„ ë³µì‚¬í•˜ê³  ë¶™ì—¬ ë„£ì€ ë‹¤ìŒ..

-----------------------------------------------------------------------------------------------------------------

âº pom.xml íŒŒì¼


...
	<dependencies>
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-data-jpa</artifactId>
		</dependency>
		
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-web</artifactId>
		</dependency>

    <!--1: webì„ hateoasë¡œ ë³€ê²½í•´ ë³´ì, ëë‹¤, ì´ë ‡ê²Œ í•˜ë©´ HATEOAS ì˜ì¡´ì„±ì´ ë‹¤ìš´ë¡œë“œë  ê²ƒì´ë‹¤, pom.xmlì—ì„œ ë³€ê²½í•  ë•Œë§ˆë‹¤ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì¤‘ì§€í•œ ë‹¤ìŒ ë‹¤ì‹œ ì‹œì‘í•´ì•¼ í•œë‹¤-->
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-hateoas</artifactId>
			<version>3.3.0</version>
		</dependency>
		
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-validation</artifactId>
			<version>3.3.0</version>
		</dependency>
		
		<!--
		<dependency>
			<groupId>org.springdoc</groupId>
			<artifactId>springdoc-openapi-starter-webmvc-ui</artifactId>
			<version>2.0.2</version>
		</dependency>		

		<dependency>
			<groupId>com.fasterxml.jackson.dataformat</groupId>
			<artifactId>jackson-dataformat-xml</artifactId>
		</dependency>
		-->
	
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-devtools</artifactId>
			<scope>runtime</scope>
			<optional>true</optional>
		</dependency>
		
		<dependency>
			<groupId>com.h2database</groupId>
			<artifactId>h2</artifactId>
			<scope>runtime</scope>
		</dependency>
		<dependency>
			<groupId>org.springframework.boot</groupId>
			<artifactId>spring-boot-starter-test</artifactId>
			<scope>test</scope>
		</dependency>
	</dependencies>
...

-----------------------------------------------------------------------------------------------------------------

ì´ì œ UserResourceë¡œ ì´ë™í•´ë³´ì
UserResourceì—ëŠ” retrieveUser ë©”ì†Œë“œê°€ ìˆëŠ”ë° retrieveUserë©”ì†Œë“œì˜ ì—­í• ì€ ë¬´ì—‡ì´ì§€?
http://localhost:8080/users/1ë¥¼ ì‹¤í–‰í•˜ë©´ 
{
  "id": 1,
  "name": "Adam",
  "birthDate": "1994-06-01"
}
íŠ¹ì • ì‚¬ìš©ìì˜ ì„¸ë¶€ì‚¬í•­ì´ ë°˜í™˜ëœë‹¤
ì´ì œ ë°ì´í„°ë¥¼ ë°˜í™˜í•˜ëŠ” ê²ƒ ë¿ë§Œ ì•„ë‹ˆë¼, ì‚¬ìš©ìì—ê²Œ ë§í¬ë¥¼ ë°˜í™˜í•´ì•¼ í•˜ëŠ”ë° 
http://localhost:8080/usersì˜ ë§í¬ë¥¼ ì¶”ê°€í•˜ê³ , ë°ì´í„°ì™€ ë§í¬ë¡œ ì‘ë‹µì„ ìƒì„±í•˜ë ¤ë©´ 
â— ìƒë‹¹íˆ ì¤‘ìš”í•œ HATEOASì˜ ë‘ ê°€ì§€ ê°œë…ì„ ì‚¬ìš©í•´ì•¼ í•˜ëŠ”ë°, ë°”ë¡œ EntityModelê³¼ WebMvcLinkBuilderì´ë‹¤ â—

User ë¹ˆì˜ ì¼ë¶€ë¡œ ì‘ë‹µì— ëª‡ ê°œ ë§í¬ë¥¼ ì¶”ê°€í•´ì•¼ í•œë‹¤
ëª¨ë“  ë¹ˆì— ëŒ€í•œ ì´ êµ¬ì¡°ë¥¼ ë³€ê²½í•´ì„œëŠ” ì•ˆ ëœë‹¤
ìš°ë¦¬ê°€ EntityModelì„ ì‚¬ìš©í•˜ëŠ” ê²ƒë„ ì´ ë–„ë¬¸ì¸ë° 
HATEOASë¥¼ ì‚¬ìš©í•˜ì—¬ ë§í¬ë¥¼ ì¶”ê°€í•˜ë ¤ë©´ ê°€ì¥ ë¨¼ì € í•´ì•¼ í•  ì¼ì€ EntityModelì—ì„œ ì‚¬ìš©ìë¥¼ ë˜í•‘í•˜ëŠ” ê²ƒì¸ë°
ê·¸ëŸ¼ ì´ì œ ì‹œì‘í•´ë³´ì EntityModel<User>ë¥¼ ì…ë ¥í•´ë³´ì

-----------------------------------------------------------------------------------------------------------------


âº UserResource í´ë˜ìŠ¤íŒŒì¼



package com.in28minutes.rest.webservices.restfulwebservices.user;

import java.net.*;
import java.util.*;

import org.springframework.hateoas.*;
import org.springframework.http.*;
import org.springframework.web.bind.annotation.*;
import org.springframework.web.servlet.support.*;

import jakarta.validation.*;

@RestController
public class UserResource {

	private UserDaoService service;
	
	public UserResource(UserDaoService service) {
		this.service = service;
	}

	@GetMapping("/users")
	public List<User> retrieveAllUsers() {
		
		return service.findAll();
	}
	
	//	http://localhost:8080/users
	
	//EntityModel
	//WebMvcLinkBuilder

//2: EntityModel<User>ë¥¼ ì…ë ¥í•´ë³´ì ì´ê²ƒì´ ë°”ë¡œ ì‘ë‹µ ìœ í˜•ì´ë‹¤ ctrl+1ì„ ëˆŒëŸ¬ì„œ import'EntityModel'ì„ ì„ íƒí•´ë³´ì, ì„í¬íŠ¸ë¥¼ ì‚´í´ë³´ë©´ org.springframework.hateoas.EntityModelì„ í™•ì¸í•  ìˆ˜ ìˆë‹¤
//A simple EntityModel wrapping a domain object and adding links to it. => ë„ë©”ì¸ ê°ì²´ë¥¼ ë˜í•‘í•˜ì—¬ ë§í¬ë¥¼ ì¶”ê°€í•˜ëŠ” ê°„ë‹¨í•œ EntityModelì´ë¼ê³  í•œë‹¤ 
//retrieveUser ë©”ì†Œë“œì—ì„  ì‚¬ìš©ìì˜ EntityModelì„ ìƒì„±í•´ì•¼ í•˜ëŠ”ë° 
	@GetMapping("/users/{id}")
	public EntityModel<User> retrieveUser(@PathVariable int id) {
		User user = service.findOne(id);
		
		if(user == null)
			throw new UserNotFoundException("id:"+id);

    //2-1: EntityModel<User> entityModel = EntityModel.of() EntityModelì˜ ì •ì  ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ì½˜í…ì¸ ë¥¼ ê¸°ë°˜ìœ¼ë¡œ EntityModelê°ì²´ë¥¼ ìƒì„±í•  ìˆ˜ ìˆë‹¤
    //ì‚¬ìš©ìì— ëŒ€í•œ EntityModelì´ ìˆì–´ì•¼ í•˜ì§€,
		EntityModel<User> entityModel = EntityModel.of(user);
    
    // ì´ì œ ì´ EntityModelì„ ë°˜í™˜í•  ìˆ˜ ìˆëŠ”ë° User í´ë˜ìŠ¤ë¥¼ ë˜í•‘í•˜ê³  EntityModelì„ ìƒì„±í•˜ëŠ” ê²ƒì´ë‹¤
		return entityModel;

	}

	@DeleteMapping("/users/{id}")
	public void deleteUser(@PathVariable int id) {
		service.deleteById(id);
		
	}
	
	@PostMapping("/users")
	public ResponseEntity<User> createUser(@Valid @RequestBody User user) {
		User savedUser = service.save(user);
		// /users/4 => /users /{id},  user.getID
		URI location = ServletUriComponentsBuilder.fromCurrentRequest()
						.path("{id}")
						.buildAndExpand(savedUser.getId())
						.toUri();  
		
		return ResponseEntity.created(location).build();
	}
}

-----------------------------------------------------------------------------------------------------------------
ì§€ê¸ˆ ìš”ì²­ì„ ì‹¤í–‰í•˜ë©´ ì•„ë¬´ëŸ° ë³€ê²½ì‚¬í•­ë„ í™•ì¸í•  ìˆ˜ ì—†ëŠ”ë°                                          |
                                                                                            V
-----------------------------------------------------------------------------------------------------------------

ğŸŒ http://localhost:8080/users/1 ì‚¬ì´íŠ¸ í™”ë©´ ==>


{
  "id": 1,
  "name": "Adam",
  "birthDate": "1994-06-01"
}

-----------------------------------------------------------------------------------------------------------------
ì´ìœ ê°€ ë­˜ê¹Œ? 
	@GetMapping("/users/{id}")
	public EntityModel<User> retrieveUser(@PathVariable int id) {
		User user = service.findOne(id);
		
		if(user == null)
			throw new UserNotFoundException("id:"+id);
		
		EntityModel<User> entityModel = EntityModel.of(user);
		
		return entityModel;
	}
ì´ê³³ì— ë§í¬ë¥¼ ì¶”ê°€í•˜ì§€ ì•Šì•˜ê¸° ë•Œë¬¸ì´ì§€ 

-----------------------------------------------------------------------------------------------------------------


âº UserResource í´ë˜ìŠ¤íŒŒì¼



package com.in28minutes.rest.webservices.restfulwebservices.user;

//3-1: import staticì„ ì…ë ¥í•˜ê³  ì´ëŸ½ê²Œ ë¶™ì—¬ ë„£ì–´ë³´ì WebMvcLinkBuilder.*ë¡œ ë§ˆë¬´ë¦¬í•˜ëŠ” ê²Œ ì¢‹ê² ë‹¤ ì´ ë°©ë²•ì´ ë” ê°„ë‹¨í•˜ë‹¤, WebMvcLinkBuilderì— ìˆëŠ” ëª¨ë“  ë©”ì†Œë“œì— ëŒ€í•œ ì •ì  ì„í¬íŠ¸ë¥¼ ìˆ˜í–‰í•˜ëŠ” ê²ƒì´ë‹¤, ì§€ê¸ˆì€ ì¼ë°˜ì ì¸ ì‚¬í•­ë§Œ ê°–ì¶”ê³  ìˆëŠ” ê²ƒì´ ì¢‹ì„ ê²ƒ ê°™ë‹¤ //3-2: ë‹¤ì‹œ retrieveUsser ë©”ì†Œë“œë¡œ ...
//ì´ íŠ¹ì • ë©”ì†Œë“œì—ì„œë§Œ ì„í¬íŠ¸ í•˜ê¸° ìœ„í•´ì„œ ì„í¬íŠ¸ëŠ” ë‚˜ì¤‘ì— ì •ë¦¬í•˜ë„ë¡ í•˜ê³  
import static org.springframework.hateoas.server.mvc.WebMvcLinkBuilder.*;

import java.net.*;
import java.util.*;

import org.springframework.hateoas.*;
import org.springframework.http.*;
import org.springframework.web.bind.annotation.*;
import org.springframework.web.servlet.support.*;

import jakarta.validation.*;

@RestController
public class UserResource {

	private UserDaoService service;
	
	public UserResource(UserDaoService service) {
		this.service = service;
	}

	@GetMapping("/users")
	public List<User> retrieveAllUsers() {
		
		return service.findAll();
	}
	
	//	http://localhost:8080/users
	
	//EntityModel
	//WebMvcLinkBuilder
	
	@GetMapping("/users/{id}")
	public EntityModel<User> retrieveUser(@PathVariable int id) {
		User user = service.findOne(id);
		
		if(user == null)
			throw new UserNotFoundException("id:"+id);
		
		EntityModel<User> entityModel = EntityModel.of(user);

  //3: ë§í¬ë¥¼ ë°˜í™˜í•˜ë ¤ë©´ EntityModelì— ë§í¬ë¥¼ ì¶”ê°€í•´ì•¼ í•œë‹¤ ë§í¬ë¥¼ ìƒì„±í•˜ë ¤ë©´ WebMvcLinkBuilderë¼ëŠ” ìœ í‹¸ë¦¬í‹° í´ë˜ìŠ¤ë¥¼ ì´ê³³ì— ì…ë ¥í•˜ê³  ctrl+spaceë¥¼ ëˆ„ë¥¸ë‹¤
  //org.springframework.hateoas.server.mvcë¥¼ í™•ì¸í•  ìˆ˜ ìˆëŠ”ë°, ( Builder to ease building Link instances pointing to Spring MVC controllers. )=> ìŠ¤í”„ë§MVC ì»¨íŠ¸ë¡¤ëŸ¬ë¥¼ ê°€ë¦¬í‚¤ëŠ” ë§í¬ ì¸ìŠ¤í„´ìŠ¤ì˜ êµ¬ì¶•ì„ ìš©ì´í•˜ê²Œ í•˜ëŠ” ë¹Œë”ë¼ê³  í•œë‹¤
  //ì—¬ê¸° ìˆëŠ” ë©”ì†Œë“œ ì¤‘ í•˜ë‚˜ì˜ ë§í¬ë¥¼ ìƒì„±í•´ì•¼ í•œë‹¤ ë°”ë¡œ ì´ê³³ì—ì„œ WebMvcLinkBuilderë¥¼ ì‚¬ìš©í•´ì•¼ í•œë‹¤ ì´ê²ƒì„ ì„í¬íŠ¸ í•˜ê² ë‹¤, 
  /*
  WrbMvcLinkBuilder í´ë˜ìŠ¤ë¥¼ ì—´ë©´ ì—¬ëŸ¬ ë©”ì†Œë“œë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤, linkTië©”ì†Œë“œì™€ methodOn ë©”ì†Œë“œë¥¼ í™•ì¸í•  ìˆ˜ ìˆëŠ”ë° íŠ¹ì • ë©”ì†Œë“œì˜ ë§í¬ë¥¼ ê°€ì ¸ì˜¤ë ¤ë©´ ì´ê²ƒì„ ë§í¬ë¡œ ì¶”ê°€í•´ì•¼ í•œë‹¤ 
    public static <T> T methodOn(Class<T> controller, Object... parameters) {
		return DummyInvocationUtils.methodOn(controller, parameters);
	  }
  ìš°í´ë¦­ methodOnì— ëŒ€í•œ Copy Qualified Nameì„ ì„ íƒí•œë‹¤ //3-1: ìœ„ë¡œ ê°€ì„œ pakageì•„ë˜ì— ì‘ì„±...
  */

   //3-2: ì—¬ê¸°ì—ì„  retrieveAllUsers() ë©”ì†Œë“œì— ëŒ€í•œ ë§í¬ë¥¼ ì¶”ê°€í•´ì•¼ í•˜ëŠ”ë°(retrieveAllUsers()ì°¸ê³ í•˜ë©´ì„œ ë³´ê¸°) ì‚¬ì‹¤/usersì˜ URLì„ í•˜ë“œ ì½”ë”©í•  ìˆ˜ ìˆì§€ë§Œ, ì¶”í›„ URLì´ ë³€ê²½ëœë‹¤ë©´ ì—¬ê¸°ì—ì„œ ë§í¬ë¥¼ ë³€ê²½í•´ì•¼ í•œë‹¤ëŠ” ì ì„ ê¸°ì–µí•´ì•¼ í•œë‹¤
   //ì´ëŸ¬í•œ ì´ìœ ë¡œ /usersë¥¼ í•˜ë“œì½”ë”© í•˜ëŠ” ëŒ€ì‹  ì´ íŠ¹ì • ë©”ì†Œë“œì˜ ë§í¬ë¥¼ ì–»ê² ë‹¤ê³  ì…ë ¥í•˜ëŠ” ê±´ë° í•´ë‹¹ ë§í¬ëŠ” ì‚¬ìš©í•˜ê³  ë‹¤ì‹œ ë°˜í™˜í•˜ê²Œ ëœë‹¤ ì´ íŠ¹ì • ë©”ì†Œë“œì— ëŒ€í•œ ë§í¬ë¥¼ ì–»ìœ¼ë ¤ë©´ linkTo(methodOn)ì„ ì…ë ¥í•œë‹¤
   //linkTo(methodOn(null, null) => ì–´ë–¤ í´ë˜ìŠ¤ë¥¼ ì¨ì•¼ í• ê¹Œ? this.getClassì§€ ë©”ì†Œë“œëŠ” ì´ íŠ¹ì • í´ë˜ìŠ¤ì—ì„œ ì •ì˜ë˜ì—ˆìœ¼ë¯€ë¡œ ë‘ ë²ˆì§¸ ë§¤ê°œë³€ìˆ˜ëŠ” í•„ìš”í•˜ì§€ ì•ŠëŠ”ë‹¤ nullì„ ì‚­ì œí•œë‹¤ìŒ .ì„ ì¶”ê°€í•˜ê³  retrieveAllUsersì— ëŒ€í•œ ë§í¬ë¥¼ ìƒì„±í•´ì•¼ í•œë‹¤
   //ì§€ê¸ˆ ì—¬ê¸°ì„œëŠ” WebMvcLinkBuilder.linkTo ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ ì»¨íŠ¸ë¡¤ëŸ¬ ë©”ì†Œë“œë¥¼ ê°€ë¦¬í‚¤ëŠ” ë§í¬ë¥¼ ìƒì„±í•˜ê³  ìˆëŠ”ë° ê°€ë¦¬í‚¤ê³  ìˆëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ ë©”ì†Œë“œëŠ” retrieveAllUsersì´ë©°, ë§í¬ê°€ ì£¼ì–´ì§€ë©´ entityModelì— ì¶”ê°€í•  ìˆ˜ ìˆë‹¤ 
    WebMvcLinkBuilder link = linkTo(methodOn(this.getClass()).retrieveAllUsers());

    //3-3: entityModel.addì— ì´ íŠ¹ì • ë§í¬ë¥¼ ì¶”ê°€í•œë‹¤, link.withRelì„ ì…ë ¥í•˜ê³  
    /*
     "_links": {
      "all-users": {
      "href": "http://localhost:8080/users" 
     }
    */
    //ì—¬ê¸°ë¥¼ ì‚´í´ë³´ë‹ˆ ë¦¬ì†ŒìŠ¤ì™€ ë§í¬ ì‚¬ì´ì— ë§í¬ë¥¼ ì§€ì •í•´ì•¼ í•˜ëŠ”ë°, ë°”ë¡œ ì—¬ê¸° ìˆëŠ” all-usersë¥¼ ì§€ì •í•´ì•¼ í•˜ì§€ ("all-users"));ë¡œ ë§ˆë¬´ë¦¬í•´ë³´ì
    //ì´ë ‡ê²Œ ë§í¬ë¥¼ ìƒì„±í•˜ê³  entityModelì— ì¶”ê°€í•œ ë‹¤ìŒ ì €ì¥í–ˆë‹¤
		entityModel.add(link.withRel("all-users"));

    return entityModel;

	}

	@DeleteMapping("/users/{id}")
	public void deleteUser(@PathVariable int id) {
		service.deleteById(id);
		
	}
	
	@PostMapping("/users")
	public ResponseEntity<User> createUser(@Valid @RequestBody User user) {
		User savedUser = service.save(user);
		// /users/4 => /users /{id},  user.getID
		URI location = ServletUriComponentsBuilder.fromCurrentRequest()
						.path("{id}")
						.buildAndExpand(savedUser.getId())
						.toUri();  
		
		return ResponseEntity.created(location).build();
	}
}

-----------------------------------------------------------------------------------------------------------------
ì´ì œ localhost:8080/users/1ì„ ì‹¤í–‰í•˜ë©´                                                    |
                                                                                         V
-----------------------------------------------------------------------------------------------------------------

ğŸŒ http://localhost:8080/users/1 ì‚¬ì´íŠ¸í™”ë©´ ==>



{
  "id": 1,
    "name": "Adam",
    "birthDate": "1994-06-01",
    "_links": {
      "all-users": {
      "href": "http://localhost:8080/users"
    }
  }
}

-----------------------------------------------------------------------------------------------------------------
_linksì™€ all-usersë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤ 
ì´ì œ ì†Œë¹„ìê°€ ì´ ì‘ë‹µì„ ë°›ìœ¼ë©´ ëª¨ë“  ì‚¬ìš©ìì˜ ì„¸ë¶€ ì‚¬í•­ì„ ì–»ëŠ” ë°©ë²• ë˜í•œ ì•Œ ìˆ˜ ìˆë‹¤ 
ì—¬ê¸°ì„œëŠ” ë‹¨ì§€ ì˜ˆì‹œë§Œ í™•ì¸í•  ìˆ˜ ìˆëŠ”ë° íŠ¹ì • ë¦¬ì†ŒìŠ¤ì— ë”°ë¼ ì›í•˜ëŠ” ë§Œí¼ ë§ì€ ë§í¬ë¥¼ ì¶”ê°€í•  ìˆ˜ ìˆë‹¤







ì´ë²ˆ ì‹œê°„ì—ëŠ” HATEOAS, ì¦‰ ì• í”Œë¦¬ì¼€ì´ì…˜ì˜ ìƒíƒœë¥¼ ë‚˜íƒ€ë‚´ëŠ” ì—”ì§„ìœ¼ë¡œ ì‚¬ìš©í•˜ëŠ” í•˜ì´í¼ë¯¸ë””ì–´ì— ëŒ€í•´ ì•Œì•„ë´¤ë‹¤
ì¼ë°˜ì ìœ¼ë¡œ REST APIì— ëŒ€í•´ ì´ì•¼ê¸°ë¥¼ í•  ë•Œë§ˆë‹¤ ë°ì´í„°ë¥¼ ë‹¤ë£¨ê²Œ ëœë‹¤ 
HATEOASëŠ” ë°ì´í„°ë¥¼ í•œ ë‹¨ê³„ ë” ì—…ê·¸ë ˆì´ë“œ ì‹œì¼œ ì¤€ë‹¤, ë°ì´í„° ì™¸ì—ë„ 
ëª‡ ê°œì˜ ë§í¬ë¥¼ ë°˜í™˜í•˜ì—¬ ì†Œë¹„ìì—ê²Œ í›„ì† ì‘ì—…ì„ ìˆ˜í–‰í•˜ëŠ” ë°©ë²•ì„ ì•Œë ¤ì¤„ ìˆ˜ ìˆì„ê¹Œ?
ë‹¤ìŒ ê°•ì˜ì—ì„œ ì•Œì•„ë³´ê² ë‹¤
