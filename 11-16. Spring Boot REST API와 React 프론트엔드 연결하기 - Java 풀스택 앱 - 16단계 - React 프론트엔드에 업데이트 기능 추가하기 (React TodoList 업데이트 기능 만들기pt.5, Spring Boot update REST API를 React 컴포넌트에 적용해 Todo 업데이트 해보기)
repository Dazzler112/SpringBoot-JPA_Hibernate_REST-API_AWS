

ì§€ë‚œ ë‹¨ê³„ì—ì„œ ìš°ë¦¬ëŠ” Todoë¥¼ ì—…ë°ì´íŠ¸í•˜ê³  ì‚­ì œí•˜ê¸° ìœ„í•œ REST APIë¥¼ ë§Œë“¤ì—ˆë‹¤ 
ê·¸ëŸ¼ ì´ë²ˆ ë‹¨ê³„ì—ì„œ ê·¸ê²ƒë“¤ì„ ì‚¬ìš©í•´ë³´ê¸°ë¡œ í•˜ì

ìš°ë¦° Todosì—ì„œ Updateë¥¼ í´ë¦­í•˜ë©´ Update APIë¥¼ í˜¸ì¶œí•˜ë ¤ê³  í•œë‹¤
ê·¸ëŸ¼ ê·¸ê±¸ ì‹œì‘í•´ë³´ì

TodoApiService.jsxë¡œ ê°€ë³´ì
ìš°ë¦¬ëŠ” ì—¬ê¸°ì„œ Update APIë¥¼ í˜¸ì¶œí•˜ë ¤ê³  í•œë‹¤

------------------------------------------------------------------------------------------------------------------

âº vsc


âº TodoApiService.jsx



import axios from 'axios'


// export function retrieveHelloWorldBean() {
//     return axios.get('http://localhost:8080/hello-world-bean')
// }

const apiClient = axios.create(
    {
        baseURL: 'http://localhost:8080'
    }
)

export const retrieveAllTodosForUsernameApi
        = (username) => apiClient.get(`/users/${username}/todos`)
        // http://localhost:8080/users/in28minutes/todos

export const deleteTodoApi
        = (username, id) => apiClient.delete(`/users/${username}/todos/${id}`)
        // http://localhost:8080/users/in28minutes/todos        
    
export const retrieveTodoApi
        = (username, id) => apiClient.get(`/users/${username}/todos/${id}`)
        // http://localhost:8080/users/in28minutes/todos            

//1: ê·¸ëŸ¼ export constë¼ê³  í•˜ê³  updateTodoApi í˜¸ì¶œì„ í•˜ë ¤ê³  í•˜ì§€, ê·¸ë¦¬ê³  ì´ê±´ apiClient.put()ì´ ë  ê²ƒì´ë‹¤
export const updateTodoApi

    //1-1: ì´ apiClient.put()ì€ usernameê³¼ id ì´ì™¸ì—ë„ todo ì„¸ë¶€ì •ë³´ê°€ í•„ìš”í•œ íŠ¹ìˆ˜í•œ ê²ƒì´ì§€, ê·¸ëŸ¼ Todo ì„¸ë¶€ì •ë³´ë¥¼ ë°›ì•„ì•¼ í•˜ê³ , Todo ì„¸ë¶€ì •ë³´ëŠ” ìš”ì²­ì˜ ë³¸ë¬¸ì´ ë  ê²ƒì´ë‹¤
        = (username, id, todo) => apiClient.put(`/users/${username}/todos/${id}`)
        // http://localhost:8080/users/in28minutes/todos 

------------------------------------------------------------------------------------------------------------------

ê·¸ëŸ¼ ìš°ë¦¬ê°€ Talend API Testerì—ì„œ ì „ì†¡í•œ ê²ƒê³¼ ë§ˆì°¬ê°€ì§€ë¡œ, ë„ˆëŠ” ìš”ì²­ ë³¸ë¬¸ì˜ ì¼ë¶€ë¡œì„œ
Todo ì„¸ë¶€ì •ë³´ë¥¼ ì „ì†¡í•´ì•¼ í•˜ì§€

------------------------------------------------------------------------------------------------------------------

âº vsc


âº TodoApiService.jsx




import axios from 'axios'


// export function retrieveHelloWorldBean() {
//     return axios.get('http://localhost:8080/hello-world-bean')
// }

const apiClient = axios.create(
    {
        baseURL: 'http://localhost:8080'
    }
)

export const retrieveAllTodosForUsernameApi
        = (username) => apiClient.get(`/users/${username}/todos`)
        // http://localhost:8080/users/in28minutes/todos

export const deleteTodoApi
        = (username, id) => apiClient.delete(`/users/${username}/todos/${id}`)
        // http://localhost:8080/users/in28minutes/todos        
    
export const retrieveTodoApi
        = (username, id) => apiClient.get(`/users/${username}/todos/${id}`)
        // http://localhost:8080/users/in28minutes/todos    

export const updateTodoApi
                              //2: ê·¸ë¦¬ê³  ë„ˆëŠ” ì¶”ê°€ íŒŒë¼ë¯¸í„°ì¸ todoë¥¼ ì¶”ê°€í•˜ë©´ ê°„ë‹¨íˆ ê·¸ë ‡ê²Œ í•  ìˆ˜ ìˆë‹¤, ì¦‰ ì´ URLì— ì´ ë³¸ë¬¸ì´ ì œì¶œë˜ëŠ” ê²ƒì´ë‹¤ (..${id}', todo)
        = (username, id) => apiClient.put(`/users/${username}/todos/${id}` ,todo)
        // http://localhost:8080/users/in28minutes/todos         
------------------------------------------------------------------------------------------------------------------

ì´ì œ ìš°ë¦¬ëŠ” updateTodoApië¥¼ TodoComponentì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆë‹¤
ìš°ë¦° ì–´ë””ì„œ ê·¸ê±¸ í˜¸ì¶œí• ê¹Œ?

------------------------------------------------------------------------------------------------------------------

âº vsc


âº TodoComponent.jsx



import {useParams} from 'react-router-dom'
import { retrieveTodoApi } from './api/TodoApiService'
import { useAuth } from './security/AuthContext'
import { useEffect, useState } from 'react'
import { Formik, Form, Field, ErrorMessage } from 'formik'


export default function TodoComponent() {

    const {id} = useParams()

    const[description, setDescription] = useState('')

    const[targetDate, setTargetDate] = useState('')

    const authContext = useAuth()

    const username = authContext.username

    useEffect(
        () => retrieveTodos(),
        [id]
        )

    function retrieveTodos() {
        retrieveTodoApi(username, id)
        .then(response => {
            setDescription(response.data.description)
            setTargetDate(response.data.targetDate)
        })
        .catch(error => console.log(error))
    }

    function onSubmit(values) {
        console.log(values)

      //3-1: ì—¬ê¸°ì„œ todo ê°ì²´ë¥¼ ìƒì„±í•  ê²ƒì´ë‹¤, ê·¸ëŸ¼ ë„ˆëŠ” const todo={ ë¼ê³  í•˜ê³ 
        const todo = {
          //3-2: idëŠ” ë­˜ê¹Œ? Todoë¥¼ ì±„ìš¸ idëŠ” idì™€ ê°™ì„ ê²ƒì´ë‹¤ ê·¸ëŸ¼ ìš°ë¦° idë¥¼ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•˜ë ¤ í•˜ê³  ê·¸ëŸ¼ idëŠ” id ìì²´ê°€ ë  ê²ƒì´ê³ 
            id : id ,
            //3-3: usernameë„ ê·¸ëŒ€ë¡œ ì‚¬ìš©í•  ê²ƒì´ë‹¤,  usernameë„ usernameì´ ë  ê²ƒì´ë‹¤
            username : username,
        }

      //3: ìš°ë¦° onSubmit()ì—ì„œ updateTodoApi()ë¥¼ í˜¸ì¶œí•  ê²ƒì´ë‹¤
      //ê·¸ë¦¬ê³  updateTodoApië¥¼ í˜¸ì¶œí•˜ê¸° ìœ„í•´ ëª‡ ê°€ì§€ ê°’ì´ í•„ìš”í•˜ì§€, ìš°ë¦° ë¬´ì—‡ì´ í•„ìš”í• ê¹Œ? username, idê°€ í•„ìš”í•˜ê³  ê·¸ê±´ì´ë¯¸ retrieveTodo()ì˜ retrieveTodoApi(username, id)ë§Œë“¤ë•Œ í–ˆê¸°ì— ì—¬ê¸°ì— ìˆë‹¤ 
      //ì´ë ‡ê²Œ usernameê³¼ idê°€ ì¤€ë¹„ë˜ì—ˆê³  (updateTodoApi()ì— username,id ì¨ì£¼ê¸°), ë§ˆì§€ë§‰ìœ¼ë¡œ í•„ìš”í•œ ê±´ todo ê°ì²´ì´ë‹¤, todoê°ì²´ê°€ ìˆì–´ì•¼ í•˜ê³  
      updateTodoApi(username, id, todo)
    }

    function validate(values) {
        let errors = {
            // description: 'Enter a valid description',
            // targetDate: 'Enter a valid targetDate'
        }

        if(values.description.length < 5) {
            errors.description = 'Enter atleast 5 characters'
        }    

        if(values.targetDate.length == null) {
            errors.targetDate = 'Enter a target date'
        }         

        console.log(values)
        return errors
    }

    return (
        <div className="container">
            <h1>Enter Todo Details</h1>
            <div>
                <Formik initialValues={{ description ,targetDate }}
                    enableReinitialize = {true}
                    onSubmit={onSubmit}
                    validate={validate}
                    validateOnChange = {false}
                    validateOnBlur = {false}
                >
                    {
                    (props) =>  (
                        <Form>
                            <ErrorMessage 
                                name="description"
                                component="div"
                                className="alert alert-warning"
                            />
                            <ErrorMessage 
                                name="targetDate"
                                component="div"
                                className="alert alert-warning"
                            />
                            <fieldset className="form-group">
                                <label>Description</label>
                                <Field type="text" className="form-control" name="description"/>
                            </fieldset>
                            <fieldset className="form-group">
                                <label>Target Date</label>
                                <Field type="date" className="form-control" name="targetDate"/>
                            </fieldset>
                            <div>
                                <button className="btn btn-success m-5" type="submit">Save</button>
                            </div>
                        </Form>
                    )
                }
                </Formik>
            </div>
        </div>
    ) 
}
------------------------------------------------------------------------------------------------------------------

ê·¸ë¦¬ê³  ë‹¤ìŒì€ descriptionê³¼ targetDateì§€
ê·¸ëŸ¼ ì´ê²ƒë“¤ë„ retreieveTodos() ì•ˆì— 
--------------------------
    function retrieveTodos() {
        retrieveTodoApi(username, id)
        .then(response => {
            setDescription(response.data.description)
            setTargetDate(response.data.targetDate)
        })
        .catch(error => console.log(error))
    }
--------------------------
ìˆë‹¤

------------------------------------------------------------------------------------------------------------------

âº vsc


âº TodoComponent.jsx



import {useParams} from 'react-router-dom'
import { retrieveTodoApi } from './api/TodoApiService'
import { useAuth } from './security/AuthContext'
import { useEffect, useState } from 'react'
import { Formik, Form, Field, ErrorMessage } from 'formik'


export default function TodoComponent() {

    const {id} = useParams()

    const[description, setDescription] = useState('')

    const[targetDate, setTargetDate] = useState('')

    const authContext = useAuth()

    const username = authContext.username

    useEffect(
        () => retrieveTodos(),
        [id]
        )

    function retrieveTodos() {
        retrieveTodoApi(username, id)
        .then(response => {
            setDescription(response.data.description)
            setTargetDate(response.data.targetDate)
        })
        .catch(error => console.log(error))
    }

    function onSubmit(values) {
        console.log(values)
        const todo = {
            id: id,
            username: username

            //4: ì´ë ‡ê²Œ descriptionê³¼ targetDateë¥¼ ì„¤ì •í•  ìˆ˜ ìˆì§€
            description,
            targetDate
        }
        
        updateTodoApi(username, id, todo)
    }

    function validate(values) {
        let errors = {
            // description: 'Enter a valid description',
            // targetDate: 'Enter a valid targetDate'
        }

        if(values.description.length < 5) {
            errors.description = 'Enter atleast 5 characters'
        }    

        if(values.targetDate.length == null) {
            errors.targetDate = 'Enter a target date'
        }         

        console.log(values)
        return errors
    }

    return (
        <div className="container">
            <h1>Enter Todo Details</h1>
            <div>
                <Formik initialValues={{ description ,targetDate }}
                    enableReinitialize = {true}
                    onSubmit={onSubmit}
                    validate={validate}
                    validateOnChange = {false}
                    validateOnBlur = {false}
                >
                    {
                    (props) =>  (
                        <Form>
                            <ErrorMessage 
                                name="description"
                                component="div"
                                className="alert alert-warning"
                            />
                            <ErrorMessage 
                                name="targetDate"
                                component="div"
                                className="alert alert-warning"
                            />
                            <fieldset className="form-group">
                                <label>Description</label>
                                <Field type="text" className="form-control" name="description"/>
                            </fieldset>
                            <fieldset className="form-group">
                                <label>Target Date</label>
                                <Field type="date" className="form-control" name="targetDate"/>
                            </fieldset>
                            <div>
                                <button className="btn btn-success m-5" type="submit">Save</button>
                            </div>
                        </Form>
                    )
                }
                </Formik>
            </div>
        </div>
    ) 
}
------------------------------------------------------------------------------------------------------------------

ê·¸ëŸ¼ ì—¬ê¸° ëª¨ë“  í•„ë“œë¥¼ ë„£ì—ˆëŠ”ì§€ í™•ì¸í•´ë³´ì
--------------------------------------------------------------------------------------------------------------------------------

ğŸ–‡ Talend API Tester í™”ë©´ ==>    (ë” ìì„¸í•œê±´ í¬ë¡¬ í™•ì¥í”„ë¡œê·¸ë¨ Talend API Tester ì‹¤í–‰í•´ì„œ í™•ì¸..)

  METHOD                SCHEME :// HOST [ ":" PORT ] [ PATH [ "?" QUERY ]]
  ______________      ____________________________________________________________    ___________________
 | POST     | â–¼  |    |    http://localhost:8080/users/in28minutes/todos/1        |  |  âœˆ Send       | â–½ |
  â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾      â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾    â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾
                        â–¶ QUERY PARAMETERS
  HEADERS   â¬‡                   | Form â–¼ |   â—€ | â–¶  BODY                                   | Text â–¼ |
â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾     |   â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾
   _______________     __________________      |    
â˜‘ | Accept        | : |application/json  | x   |    {                          
   â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾     â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾      |       "username": "in28minutes",                              
  ______________                               |       "description": "Learn To Dance",                          
 ( + Add header )  ğŸ— Add authorization     ğŸ—‘  |       "targetDate": "2033-08-04",                            
  â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾                               |       "done": false  
                                               |    }            
                                               |      
                                               |    â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾
                                                   Text JSON XML HTML | Format Body |
                                                    â˜‘ Enable body evaluation

                                   

--------------------------------------------------------------------------------------------------------------------------------
username, description, targetDate, doneì´ë‹¤ 


------------------------------------------------------------------------------------------------------------------

âº vsc


âº TodoComponent.jsx




import {useParams} from 'react-router-dom'
import { retrieveTodoApi } from './api/TodoApiService'
import { useAuth } from './security/AuthContext'
import { useEffect, useState } from 'react'
import { Formik, Form, Field, ErrorMessage } from 'formik'


export default function TodoComponent() {

    const {id} = useParams()

    const[description, setDescription] = useState('')

    const[targetDate, setTargetDate] = useState('')

    const authContext = useAuth()

    const username = authContext.username

    useEffect(
        () => retrieveTodos(),
        [id]
        )

    function retrieveTodos() {
        retrieveTodoApi(username, id)
        .then(response => {
            setDescription(response.data.description)
            setTargetDate(response.data.targetDate)
        })
        .catch(error => console.log(error))
    }

    function onSubmit(values) {
        console.log(values)
        const todo = {
            id: id,
            username: username,

            //5-2: descriptionì€ descriptionì´ë‹¤ 
            description,

            //5-1: targetDateëŠ” targetDateì´ê³ 
            targetDate: targetDate,

            //5: ì—¬ê¸°ì„œ ëª¨ë“  ê²ƒì—ëŒ€í•´ doneì˜ ê°’ì€ falseì¼ ê²ƒì´ë‹¤
            done: false
        }

        //5-3: ê·¸ëŸ¼ updateTodoApië¥¼ í˜¸ì¶œí•˜ê¸° ì „ì— console.log(todo)ë¥¼ í•  ê±°ê³ , ì´ê±¸ ì €ì¥í•´ë³´ì
        console.log(todo)
        
        // updateTodoApi(username, id, todo) (<= ì ê¹ ì£¼ì„ ì²˜ë¦¬)
    }

    function validate(values) {
        let errors = {
            // description: 'Enter a valid description',
            // targetDate: 'Enter a valid targetDate'
        }

        if(values.description.length < 5) {
            errors.description = 'Enter atleast 5 characters'
        }    

        if(values.targetDate.length == null) {
            errors.targetDate = 'Enter a target date'
        }         

        console.log(values)
        return errors
    }

    return (
        <div className="container">
            <h1>Enter Todo Details</h1>
            <div>
                <Formik initialValues={{ description ,targetDate }}
                    enableReinitialize = {true}
                    onSubmit={onSubmit}
                    validate={validate}
                    validateOnChange = {false}
                    validateOnBlur = {false}
                >
                    {
                    (props) =>  (
                        <Form>
                            <ErrorMessage 
                                name="description"
                                component="div"
                                className="alert alert-warning"
                            />
                            <ErrorMessage 
                                name="targetDate"
                                component="div"
                                className="alert alert-warning"
                            />
                            <fieldset className="form-group">
                                <label>Description</label>
                                <Field type="text" className="form-control" name="description"/>
                            </fieldset>
                            <fieldset className="form-group">
                                <label>Target Date</label>
                                <Field type="date" className="form-control" name="targetDate"/>
                            </fieldset>
                            <div>
                                <button className="btn btn-success m-5" type="submit">Save</button>
                            </div>
                        </Form>
                    )
                }
                </Formik>
            </div>
        </div>
    ) 
}
------------------------------------------------------------------------------------------------------------------

Todoë¡œ ê°€ì„œ Saveë¥¼ í´ë¦­í•œë‹¤ ê·¸ë¦¬ê³  ìš°í´ë¦­> Inspect(ê²€ì‚¬)ë¥¼ ì„ íƒí•˜ì
                                            |  
                                            V
------------------------------------------------------------------------------------------------------------------

ğŸŒ http://localhost:3000/todos ì‚¬ì´íŠ¸í™”ë©´ ==>



          in28minutes                                                                          Logout
     ______________________________________________________________________________________________________

                                            Enter Todo Details

                                                Description
               ________________________________________________________________________________ 
              | Get AWS Certified                                                              |
               â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾
                                                Target Date
               ________________________________________________________________________________ 
              | 2034-08-02()                                                              ğŸ“…   |
               â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾â€¾
                                                   ______        
                                                  | Save |
                                                   â€¾â€¾â€¾â€¾â€¾â€¾

------------------------------------------------------------------------------------------------------------------
  Elements  Console  Sources Network  Performance      >>                                           ğŸ”…  â  x
            â€¾â€¾â€¾â€¾â€¾â€¾â€¾
------------------------------------------------------------------------------------------------------------------
â–¼ {id: '1', username: 'in28minutes', description: 'Get AWS 
    Certified', targetDate: '2034-08-05', done: false}
    description: "Get AWS Certified"
    done: false
    id: "1"
    targetDate: "2034-08-05"
    username: "in28minutes"
   â–¶[[Prototype]]: Object
------------------------------------------------------------------------------------------------------------------

Objectê°€ í”„ë¦°íŠ¸ë˜ê³  ìˆê³ , ê±°ê¸°ì— ì´ ëª¨ë“  ê°’ë“¤ì´ ìˆë‹¤
descriptionì€ Get AWS Certifiedì´ê³ 
doneì€ falseê³  
idëŠ” 1,
targetDateëŠ” 2034-08-05ì´ë‹¤ 
ì¢‹ë‹¤ 
usernameì€ in28minutesì´ë‹¤ 
