

Social Media Application - Resources & Methods

â— Users REST API                                                                                   [
  â–  Retrieve all Users                                                                                -  {
    â—‹ GET/users                                                                                             id: 1,
                                                                                                            name: "Adam",
                                                                                                            birthDate: "2024-05-18T17:16:30.057+0000"
                                                                                                         },                                                                                                                                                                           
                                                                                                      -  {
                                                                                                            id: 2,
                                                                                                            name: "Eve",
                                                                                                            birthDate: "2024-05-18T17:16:30.057+0000"
                                                                                                         },                                    
                                                                                                     -  {
                                                                                                            id: 3,
                                                                                                            name: "Jack",
                                                                                                            birthDate: "2024-05-18T17:16:30.057+0000"
                                                                                                        }                                       
                                                                                                    ]  

ì´ë²ˆ ì‹œê°„ì—” ì‚¬ìš©ì ê´€ë ¨ REST APIë¥¼ ë§Œë“¤ì–´ ë³´ê² ë‹¤ 
ì¡°íšŒ ëŒ€ìƒì€ ëª¨ë“  ì‚¬ìš©ìì´ê³  ìš”ì²­ì€ /usersë¡œ ë³´ë‚´ë ¤ê³  í•œë‹¤

ì‹œì‘í•´ë³´ì
ë¨¼ì € íŒ¨í‚¤ì§€ë¡œ ê°€ì„œ com.in28minutes.rest.webservices.restfulwebservices.useríŒ¨í‚¤ì§€ì—ì„œ ìš°í´ë¦­í•´ ìƒˆ í´ë¦­ìŠ¤ë¥¼ ìƒì„±í•œë‹¤
ì‚¬ìš©ìë¥¼ ìœ„í•œ ë¦¬ì†ŒìŠ¤ë‹ˆê¹Œ UserResourceë¼ í•˜ê³  ì™„ë£Œí•œë‹¤

------------------------------------------------------------------------------------------------------------------------


âº UserResource í´ë˜ìŠ¤íŒŒì¼



package com.in28minutes.rest.webservices.restfulwebservices.user;

import org.springframework.web.bind.annotation.*;

//1: REST APIë¥¼ êµ¬í˜„í•˜ëŠ” ê±°ë‹ˆê¹Œ @RestControllerë¥¼ ë„£ì–´ ì£¼ê³  ì„í¬íŠ¸ë¬¸ì„ ì—…ë°ì´íŠ¸í•˜ë©´ ë“¤ì–´ì™”ë‹¤, org.springframework.web.bind.annotationì˜ RestControllerê°€ ë“¤ì–´ì™”ë‹¤
//ì—¬ê¸°ì„œ ì´ì œ ëª¨ë“  ì‚¬ìš©ìë¥¼ ì¡°íšŒí•˜ëŠ” ì²« ë²ˆì§¸ REST APIë¥¼ ì •ì˜í•  ê²ƒì´ë‹¤
@RestController
public class UserResource {

  //1-3: UserDaoServiceëŠ” Springì´ ê´€ë¦¬í•œë‹¤ @Componentê°€ ë¶™ì–´ ìˆë‹¤, ì´ê±¸ UserResourceì— AutoWireí•´ì¤€ë‹¤, ê·¸ë˜ì„œ UserResource í´ë˜ìŠ¤ì— ì¶”ê°€í•˜ê² ë‹¤
  //private UserDaoService serviceë¼ê³  í•˜ê³  
	private UserDaoService service;
  
  //ìƒì„±ì ì£¼ì…ì„ ì“¸ ê±°ë¼ì„œ ì—¬ê¸°ì— ìƒì„±ìë¥¼ ë„£ì–´ì¤€ë‹¤
  //public UserResourceê¹Œì§€ ë„£ì–´ì£¼ê³  UserDaoService service ì´ ë¶€ë¶„ì„ ë³µì‚¬í•´ì„œ ()ì—ë„£ì–´ ì£¼ê² ë‹¤ thisì˜ serviceê°’ìœ¼ë¡œ ì¸ìë¡œ ë°›ì€ ì„œë¹„ìŠ¤ë¥¼ í• ë‹¹í•œë‹¤
  //ì•„ë˜ retrieveAllUsers()ë©”ì†Œë“œì— ì»´íŒŒì¼ ì—ëŸ¬ê°€ ë‚¬ë‹¤//1-4: retrieveAllUsers()ë©”ì†Œë“œë¡œ..
  public UserResource(UserDaoService service) {
		this.service = service;
	}

  //1-1: ì´ ì‘ì—…ì„ ì—¬ê¸°ì„œ êµ¬í˜„í•  ê²ƒì´ë‹¤, ëª¨ë“  ì‚¬ìš©ìì˜ ì •ë³´ë¥¼ ì¡°íšŒí•  ê²ƒì´ë‹¤ 
  //ë©”ì†Œë“œëŠ” publicìœ¼ë¡œ ê·¸ë¦¬ê³  ë°˜í™˜ê°’ì€ ì‚¬ìš©ì ì •ë³´ ëª©ë¡ì´ë‹ˆ List<User>ë¼ê³  ì“°ê³  ë©”ì†Œë“œ ì´ë¦„ì€ retrieveAllUsersë¡œ í•œë‹¤
  //GET /users
  //1-4: ê°’ì„ ë°˜í™˜í•˜ì§€ ì•Šì•„ì„œ ì»´íŒŒì¼ ì—ëŸ¬ê°€ ë‚˜ì™”ë‹¤, ì—¬ê¸°ì„œ ê°’ì„ ë°˜í™˜í•´ ì¤„ê²ƒì´ë‹¤
  //1-5: ì—¬ê¸°ì—ì„œ @GetMappingì„ ë„£ì–´ì¤˜ì•¼ í•œë‹¤ ê·¸ë¦¬ê³  ë§¤í•‘ì€ ì´ ì•ˆì— ë“¤ì–´ê°€ëŠ” URLì´ë‘ í•´ì¤€ë‹¤ @GetMappingì˜ ê´„í˜¸ì•ˆì— "/users"ë¼ê³  ë„£ì–´ì£¼ë©´ ë˜ëŠ” ê±°ë‹¤ íŒŒì¼ì„ ì €ì¥í•˜ê³ ....... 
	@GetMapping("/users")
  public List<User> retrieveAllUsers() {
	  //1-2: ê·¸ë¦¬ê³  ì´ ì•ˆì—ì„œ ë©”ì†Œë“œë¥¼ êµ¬í˜„í•œë‹¤ ì •ë³´ëŠ” UserDaoServiceì—ì„œ ì–»ì–´ ì˜¬ ê²ƒì´ë‹¤, 

    //1-4 ê³„ì†: return service. ê·¸ë¦¬ê³  findAll()ì„ í˜¸ì¶œí•´ì¤€ë‹¤ ì´ì œ ì»´íŒŒì¼ì´ ì˜ ëë‹¤ ì´ê²Œ ëì´ ì•„ë‹ˆë‹¤ ë§¤í•‘ì„ í•´ì¤˜ì•¼ í•œë‹¤ //1-5:retrieveAllUsers()ë©”ì†Œë“œ ìœ„ë¡œ ê°€ì„œ @GetMapping ì‚¬ìš©
    return service.findAll();
	}
}

------------------------------------------------------------------------------------------------------------------------
ë¸Œë¼ìš°ì €ì—ì„œ localhost:8080/usersë¥¼ í˜¸ì¶œí•œë‹¤                                      | 
                                                                                V
------------------------------------------------------------------------------------------------------------------------

ğŸŒ http://localhost:8080/users ì‚¬ì´íŠ¸ í™”ë©´ ==>


[
  {
    "id": 1,
    "name": "Adam",
    "birthDate": "1994-05-19"
  },
  {
    "id": 2,
    "name": "Eve",
    "birthDate": "1999-05-19"
  },
  {
    "id": 1,
    "name": "Jim",
    "birthDate": "2004-05-19"
  }
]

------------------------------------------------------------------------------------------------------------------------
ì¢‹ë‹¤ ì‚¬ìš©ìë“¤ì˜ ì •ë³´ê°€ ì¡°íšŒëë‹¤

ë¬´ìŠ¨ ì¼ì´ ì¼ì–´ë‚˜ëŠ” ê±°ëƒë©´, localhostë¡œ /usersë¥¼ í˜¸ì¶œí•˜ë©´
í•´ë‹¹ ìš”ì²­ì€ return service.findAll(); ì´ ë¶€ë¶„ìœ¼ë¡œ ë“¤ì–´ì™€ì„œ UserDaoServiceë¡œ ê°„ë‹¤ìŒ
	static {
		users.add(new User(1, "Adam", LocalDate.now().minusYears(30)));
		users.add(new User(2, "Eve", LocalDate.now().minusYears(25)));
		users.add(new User(1, "Jim", LocalDate.now().minusYears(20)));
	}
ì—¬ê¸°ì—ì„œ ëª¨ë“  ì‚¬ìš©ì ì •ë³´ë¥¼ ë°˜í™˜í•˜ê³ 
ê·¸ê±¸ ì—¬ê¸° UserResourceì—ì„œ ë°›ì•„ JSONìœ¼ë¡œ ë³€í™˜í•´ì„œ ê²°ê³¼ê°€ ì—¬ê¸°ì— ë³´ì¸ë‹¤
REST API êµ¬í˜„ì´ ì™„ë£Œëë‹¤

ë‹¤ìŒìœ¼ë¡œ í•´ ë³¼ ê±´ íŠ¹ì • ì‚¬ìš©ìì˜ ì •ë³´ë¥¼ ì¡°íšŒí•´ ë³´ëŠ” ê²ƒì´ë‹¤

------------------------------------------------------------------------------------------------------------------------


âº UserResource í´ë˜ìŠ¤íŒŒì¼



package com.in28minutes.rest.webservices.restfulwebservices.user;

import java.util.*;

import org.springframework.web.bind.annotation.*;

@RestController
public class UserResource {

	private UserDaoService service;
	
	public UserResource(UserDaoService service) {
		this.service = service;
	}
	
	//GET /users
	@GetMapping("/users")
	public List<User> retrieveAllUsers() {
		
		return service.findAll();
	}

//2:ê·¸ë˜ì„œ ì´ë²ˆì—” /users ë‹¤ìŒì— /1ì„ ì¶”ê°€í•´ ì¤€ë‹¤
//ëª…ì‹œëœ ì‚¬ìš©ìì˜ ì •ë³´ë§Œ ì¡°íšŒí•˜ëŠ” APIë¡œ ë§Œë“¤ê³  ì‹¶ë‹¤, ë¨¼ì € ë©”ì†Œë“œ ì´ë¦„ì„ ë°”ê¿”ì•¼ê² ì§€?, retrieveAllUser ëŒ€ì‹  retrieveUserë¡œ ë°”ê¾¼ë‹¤
//ì—¬ê¸°ì—ì„  1ì´ ì•„ë‹ˆë¼ íŒ¨ìŠ¤ ë³€ìˆ˜ë¥¼ ë„£ì–´ì¤˜ì•¼ í•œë‹¤ /1ì´ ë˜ê±°ë‚˜ /3ì´ ë˜ê±°ë‚˜ ì•„ì´ë”” ê°’ì´ ë°”ë€Œì–´ì•¼ í•˜ë‹ˆê¹Œ ì´ê±´ íŒ¨ìŠ¤ ë³€ìˆ˜ë¡œ ì²˜ë¦¬í•´ì•¼ í•œë‹¤ íŒ¨ìŠ¤ ë³€ìˆ˜ ì´ë¦„ì€ idë¡œ í•˜ê² ë‹¤
	//GET /users
	@GetMapping("/users/{id}")
//ì¸ìë¡œëŠ” @PathVariable ê·¸ë¦¬ê³  int idë¥¼ ë„£ì€ ë‹¤ìŒ ì„í¬íŠ¸ë¥¼ í•˜ë©´ org.springframework.web.bind.annotation.PathVariableì´ ë“¤ì–´ì™”ë‹¤ ë‹¤ìŒìœ¼ë¡œ í•´ì•¼ í•  ê±´
//ì„œë¹„ìŠ¤ì— ê°€ì„œ ëª…ì‹œëœ ì•„ì´ë””ì— í•´ë‹¹í•˜ëŠ” ì •ë³´ë¥¼ ì¡°íšŒí•˜ëŠ” ê²ƒì´ë‹¤//2-1: UserDaoServiceë¡œ... 
	public User retrieveUser(@PathVariable int id) {
		
  //2-4:UserResource í´ë˜ìŠ¤ì—ì„œ service.findOne()ì„ í˜¸ì¶œí•˜ë©´ì„œ ì¸ìë¡œ idë¥¼ ì „ë‹¬í•œë‹¤ ê·¸ë¦¬ê³  ê²°ê³¼ë¥¼ ë°˜í™˜í•´ ì¤€ë‹¤, ë°˜í™˜ê°’ íƒ€ì…ë„ ë°”ê¿”ì•¼ê² ë‹¤ ctrl+1ì„ ëˆ„ë¥´ê³  ë°˜í™˜ê°’ íƒ€ì…ì„ Userë¡œ ë°”ê¾¼ë‹¤
  //retrieveUser()ë©”ì†Œë“œëŠ” ë‹¨ í•œ ëª…ì˜ User ì •ë³´ë¥¼ ë°˜í™˜í•˜ëŠ” ê±°ë‹¤ íŒŒì¼ì„ ì €ì¥í•˜ê³ .......
		return service.findOne(id);

	}
}

--------------------------------------------------------------------


âº UserDaoService í´ë˜ìŠ¤íŒŒì¼


package com.in28minutes.rest.webservices.restfulwebservices.user;

import java.time.*;
import java.util.*;

import org.springframework.stereotype.*;

@Component
public class UserDaoService {
    // JPA/Hibernate > Database
    // UserDaoService > Static List
	
	private static List<User> users = new ArrayList<>();
	
	static {
		users.add(new User(1, "Adam", LocalDate.now().minusYears(30)));
		users.add(new User(2, "Eve", LocalDate.now().minusYears(25)));
		users.add(new User(1, "Jim", LocalDate.now().minusYears(20)));
	}
	public List<User> findAll() {
		return users;
	}

	//public User save(User user) {

	//2-1: UserDaoServiceë¡œ ê°„ ë‹¤ìŒ id ê°’ì„ ê°€ì§€ê³  Userë¥¼ ë°˜í™˜í•˜ëŠ” findOne()ì´ë¼ëŠ” í¼ë¸”ë¦­ ë©”ì†Œë“œë¥¼ ë§Œë“ ë‹¤
  //ì¦‰ ì•„ì´ë”” ê°’ì„ ê°€ì§€ê³  í•´ë‹¹ë˜ëŠ” ì‚¬ìš©ìë¥¼ ì°¾ê³  í•´ë‹¹ ì‚¬ìš©ì ì •ë³´ë¥¼ ë°˜í™˜í•´ ì¤˜ì•¼ í•œë‹¤ for ë°˜ë³µë¬¸ìœ¼ë¡œ í•´ë‹¹ë˜ëŠ” ì‚¬ìš©ìë¥¼ ì°¾ì•„ ì •ë³´ë¥¼ ë°˜í™˜í•˜ëŠ” ë°©ë²•ì´ ìˆê³  í•¨ìˆ˜í˜• í”„ë¡œê·¸ë˜ë°ì„ ì“°ëŠ” ë°©ë²•ë„ ìˆë‹¤
	public User findOne(int id) {
  //2-2: í•¨ìˆ˜í˜• í”„ë¡œê·¸ë˜ë°ìœ¼ë¡œ ëª©ë¡ì—ì„œ í•´ë‹¹ë˜ëŠ” ì‚¬ìš©ìë¥¼ ì¡°íšŒí•˜ë ¤ë©´ users.stream Listë¥¼ Stream í˜•íƒœë¡œ ë³€í™˜í•˜ê³  ê±°ê¸°ì— í•„í„°ë¥¼ ì ìš©í•´ id ê°’ìœ¼ë¡œ ì •ë³´ë¥¼ ì¡°íšŒí•˜ê¸° ìœ„í•´ .filter(predicate)ë¼ê³  í•œë‹¤
  //ë‹¤ìŒìœ¼ë¡œ ctrl+1ì„ ëˆŒëŸ¬ predicateë¼ëŠ” ì§€ì—­ ë³€ìˆ˜ë¥¼ ë§Œë“¤ê² ë‹¤ , í•´ë‹¹ ì‚¬ìš©ìë¥¼ ì–´ë–»ê²Œ ì°¾ëŠëƒ ì–´ë–»ê²Œ í•´ë‹¹ë˜ëŠ” ì‚¬ìš©ìë¥¼ ì°¾ì„ ìˆ˜ ìˆì„ê¹Œ? predicateëŠ” ì´ë ‡ê²Œ ì •ì˜ëœë‹¤ ì‚¬ìš©ìì˜ ë­”ê°€ë¥¼ í™•ì¸í•˜ëŠ” ì‘ì—…ì„ ê±°ì¹˜ëŠ”ë° ì´ êµ¬ë¬¸ì€ ëŒë‹¤ì‹ì„ ìƒì„±í•œë‹¤
  // -(í•˜ì´í”ˆ)ì— > ë¶€ë“±í˜¸ ì´ êµ¬ë¬¸ì´ë‹¤ ì‚¬ìš©ìì˜ ì•„ì´ë””ê°€ ì¸ìˆ˜ë‘ ê°™ì€ì§€ í™•ì¸í•´ì•¼ í•˜ë‹ˆ getIdë¥¼ í˜¸ì¶œí•œ ë‹¤ìŒ equalsë¡œ ë¹„êµí•œë‹¤ ì¸ìì¸ idê°’ì´ë‘ ë§ì´ë‹¤, ë‘ ì•„ì´ë”” ê°’ì´ ê°™ì€ì§€ë¥¼ í™•ì¸í•˜ëŠ” ì‘ì—…ì´ë‹¤
  //ì‚¬ìš©ìì˜ ì•„ì´ë”” ê°’ê³¼ ì¸ìê°€ ê°™ë‹¤ë©´ í•´ë‹¹ ì‚¬ìš©ìì˜ ì •ë³´ë¥¼ ë°˜í™˜í•´ì•¼ í•œë‹¤ ì—¬ê¸°ì„  User ëª©ë¡ì—ì„œ ì´ ì•„ì´ë”” ê°’ì„ ê°€ì§„ ì‚¬ìš©ìë¥¼ ê±¸ëŸ¬ë‚´ëŠ” ê²ƒì´ë‹¤ 
		Predicate<? super User> predicate = user -> user.getId().equals(id);

  //2-3: ê·¸ ë‹¤ìŒì— í•´ì•¼ í•˜ëŠ” ê±´ í•´ë‹¹ ì•„ì´ë”” ê°’ì— ê±¸ëŸ¬ì§„ ì²« ë²ˆì§¸ í•­ëª©ì„ ì°¾ëŠ” ê²ƒì´ë‹¤, ì–˜ê°€ ë°˜í™˜í•˜ëŠ” ê±´ Optionalì´ê³ , ê±°ê¸°ì— getì„ í˜¸ì¶œí•´ì„œ Userë¥¼ ë°›ëŠ”ë‹¤, ì•ì— returnì„ ì¶”ê°€í•´ì•¼ê² ì§€
		return users.stream().filter(predicate).findFirst().get();
  
  /*ğŸ”µ í•´ì„ =>
  ì—¬ê¸°ì„  Listë¥¼ ë°›ì•„ Streamìœ¼ë¡œ ë³€í™˜í•œ ë’¤ predicateë¥¼ ê¸°ì¤€ìœ¼ë¡œ í•„í„°ë¥¼ í•˜ëŠ” ê²ƒë¿ì´ë‹¤ 
  Predicateê°€ í•˜ëŠ” ê±´ ì‚¬ìš©ìì˜ ì•„ì´ë”” ê°’ì´ ì „ë‹¬ëœ ì¸ìˆ˜ì™€ ê°™ì€ì§€ë¥¼ í™•ì¸í•˜ëŠ” ê²ƒ ë¿ì´ê³ 
  ì´ User ëª©ë¡ì—ì„œ ì•„ì´ë”” ê°’ì´ ê°™ì€ ì‚¬ìš©ì í•˜ë‚˜ë§Œ ì°¾ëŠ” ê²ƒì´ë‹¤, ì˜ˆë¥¼ ë“¤ì–´ User(1, "Adam", LocalDate.now().minusYears(30) ì´ ì‚¬ìš©ìë¼ë“ ì§€ 
  filter()ì—ì„œ ëª©ë¡ì€ ë°˜í™˜í•˜ë©´ findFirst()ë¡œ ì²« ë²ˆì§¸ í•­ëª©ì„ ì°¾ì•„ ë°˜í™˜í•˜ëŠ” ì½”ë“œì´ë‹¤
  */
//  ì´ì œ êµ¬í˜„í•œ ì´ í•¨ìˆ˜ë¥¼ REST APIì—ì„œ ì‚¬ìš©í•  ì°¨ë¡€ì´ë‹¤//2-4:UserResourceí´ë˜ìŠ¤ íŒŒì¼ë¡œ..
  }
}
------------------------------------------------------------------------------------------------------------------------
ë¸Œë¼ìš°ì €ì—ì„œ /users/1ì„ ë„£ì–´ ë³¸ë‹¤                                                |
                                                                               V
------------------------------------------------------------------------------------------------------------------------

ğŸŒ http://localhost:8080/users/1 ì‚¬ì´íŠ¸ í™”ë©´ ==>


{
  "id": 1,
  "name": "Adam",
  "birthDate": "1994-05-19"
}

------------------------------------------------------------------------------------------------------------------------
ì¢‹ë‹¤ 
Adamì´ë¼ëŠ” ì‚¬ìš©ìì˜ ì •ë³´ë¥¼ users/1ë¡œ ì¡°íšŒí•´ì„œ ì•„ì´ë””ê°€ 1ì¸ Adamì˜ ì •ë³´ê°€ ë‚˜ì™”ë‹¤

/user/2ë¡œ ì¡°íšŒí•˜ë©´?
------------------------------------------------------------------------------------------------------------------------

ğŸŒ http://localhost:8080/users/1 ì‚¬ì´íŠ¸ í™”ë©´ ==>

{
  "id": 2,
  "name": "Eve",
  "birthDate": "1999-05-19"
}
------------------------------------------------------------------------------------------------------------------------
Eveì˜ ì •ë³´ê°€ ì¡°íšŒëœë‹¤




ì´ë²ˆ ì‹œê°„ì—” GET ë©”ì†Œë“œë¡œ ëª¨ë“  ì‚¬ìš©ìì˜ ì •ë³´ì™€ í•œ ì‚¬ìš©ìì˜ ì •ë³´ë¥¼ ì¡°íšŒí–ˆë‹¤
